{"asctime": "2024-11-27 05:55:47", "name": "root", "levelname": "DEBUG", "message": "Logging has been configured successfully.", "taskName": null}
{"asctime": "2024-11-27 05:55:48", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: English (en)", "taskName": "Task-5"}
{"asctime": "2024-11-27 05:55:48", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: Russian (ru)", "taskName": "Task-5"}
{"asctime": "2024-11-27 05:55:49", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: Indonesian (id)", "taskName": "Task-5"}
{"asctime": "2024-11-27 05:56:26", "name": "decorators", "levelname": "DEBUG", "message": "Initialized DatabaseService.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "llm_service", "levelname": "INFO", "message": "LLMService initialized with model 'gpt-4o'.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "decorators", "levelname": "DEBUG", "message": "Initialized LLMService.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "decorators", "levelname": "DEBUG", "message": "Set user_id: 244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "decorators", "levelname": "DEBUG", "message": "Set user_name: Andrey", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "decorators", "levelname": "DEBUG", "message": "Set language_code: en", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: English", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/start'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: start with args: (<handlers.BotHandlers object at 0x00000233779E0740>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 2, 56, 26, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=6, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2253, supergroup_chat_created=False, text='/start'), update_id=881193494), <telegram.ext._callbackcontext.CallbackContext object at 0x000002331D037230>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: start with result: <coroutine object BotHandlers.start at 0x000002337FDA2D60>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:28", "name": "handlers", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:29", "name": "handlers", "levelname": "INFO", "message": "Sent welcome message to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:29", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:33", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:33", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:33", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: English", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:33", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/language'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:33", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: language with args: (<handlers.BotHandlers object at 0x00000233779E0740>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 2, 56, 33, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=9, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2255, supergroup_chat_created=False, text='/language'), update_id=881193495), <telegram.ext._callbackcontext.CallbackContext object at 0x000002331D0356A0>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:33", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: language with result: <coroutine object BotHandlers.language at 0x000002331D078D00>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:34", "name": "handlers", "levelname": "INFO", "message": "Prompted language selection for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:34", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:36", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:36", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:36", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: English", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:36", "name": "decorators", "levelname": "INFO", "message": "Event 'inline_button' triggered by user_id=244732168, message='set_language:Russian'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:36", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: set_language with args: (<handlers.BotHandlers object at 0x00000233779E0740>, Update(callback_query=CallbackQuery(chat_instance='-7472414466751896971', data='set_language:Russian', from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), id='1051116658863615894', message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 2, 56, 33, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Pdflyx', id=7836895356, is_bot=True, username='Pdflyx_bot'), group_chat_created=False, message_id=2256, reply_markup=InlineKeyboardMarkup(inline_keyboard=((InlineKeyboardButton(callback_data='set_language:English', text='English'),), (InlineKeyboardButton(callback_data='set_language:Russian', text='\u0420\u0443\u0441\u0441\u043a\u0438\u0439'),), (InlineKeyboardButton(callback_data='set_language:Indonesian', text='Indone... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:36", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: set_language with result: <coroutine object BotHandlers.set_language at 0x000002337FDA30F0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:36", "name": "handlers", "levelname": "DEBUG", "message": "Updated language to 'Russian' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:36", "name": "handlers", "levelname": "INFO", "message": "User_id=244732168 set language to 'Russian'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:36", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=inline_button", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:40", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:40", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:40", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:40", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/status'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:40", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: status with args: (<handlers.BotHandlers object at 0x00000233779E0740>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 2, 56, 40, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=7, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2258, supergroup_chat_created=False, text='/status'), update_id=881193497), <telegram.ext._callbackcontext.CallbackContext object at 0x000002331D037850>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:40", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: status with result: <coroutine object BotHandlers.status at 0x000002337D33B610>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:40", "name": "handlers", "levelname": "INFO", "message": "Provided status to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:40", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:44", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:44", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:44", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:44", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/knowledge_base'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:44", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: knowledge_base with args: (<handlers.BotHandlers object at 0x00000233779E0740>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 2, 56, 43, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=15, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2260, supergroup_chat_created=False, text='/knowledge_base'), update_id=881193498), <telegram.ext._callbackcontext.CallbackContext object at 0x000002331D035010>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:44", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: knowledge_base with result: <coroutine object BotHandlers.knowledge_base at 0x000002337FD9B520>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:44", "name": "handlers", "levelname": "INFO", "message": "Prompted knowledge base selection for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:44", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "decorators", "levelname": "INFO", "message": "Event 'inline_button' triggered by user_id=244732168, message='set_knowledge:\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: set_knowledge_base with args: (<handlers.BotHandlers object at 0x00000233779E0740>, Update(callback_query=CallbackQuery(chat_instance='-7472414466751896971', data='set_knowledge:\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b', from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), id='1051116661716769291', message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 2, 56, 44, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Pdflyx', id=7836895356, is_bot=True, username='Pdflyx_bot'), group_chat_created=False, message_id=2261, reply_markup=InlineKeyboardMarkup(inline_keyboard=((InlineKeyboardButton(callback_data='set_knowledge:\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b', text='\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b'),), (InlineKeyboardButton(callback_data='set_knowledge:Indonesian Regulations', text='Indonesian Regulations'),... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: set_knowledge_base with result: <coroutine object BotHandlers.set_knowledge_base at 0x000002337FC5F5E0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "handlers", "levelname": "DEBUG", "message": "Set folder_path='E:\\knowledge_base\\russian_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "handlers", "levelname": "DEBUG", "message": "Found 28 valid files in folder_path='E:\\knowledge_base\\russian_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_and_index_documents with args: (<llm_service.LLMService object at 0x000002331D096B10>, 'E:\\\\knowledge_base\\\\russian_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "llm_service", "levelname": "DEBUG", "message": "Starting load_and_index_documents for folder_path='E:\\knowledge_base\\russian_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_vector_store with args: (<llm_service.LLMService object at 0x000002331D096B10>, 'E:\\\\knowledge_base\\\\russian_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "faiss.loader", "levelname": "DEBUG", "message": "Environment variable FAISS_OPT_LEVEL is not set, so let's pick the instruction set according to the current CPU", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:46", "name": "faiss.loader", "levelname": "INFO", "message": "Loading faiss with AVX2 support.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:47", "name": "faiss.loader", "levelname": "INFO", "message": "Successfully loaded faiss with AVX2 support.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:47", "name": "llm_service", "levelname": "INFO", "message": "Loaded vector store from E:\\knowledge_base\\russian_regulations\\vector_store", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:47", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_vector_store with result: True", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:47", "name": "llm_service", "levelname": "INFO", "message": "Vector store loaded from existing files in 'E:\\knowledge_base\\russian_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:47", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_and_index_documents with result: (True, 'Vector store loaded from existing files.')", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:47", "name": "handlers", "levelname": "INFO", "message": "Knowledge base '\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b' set successfully for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:47", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=inline_button", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:52", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:52", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:52", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:52", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/status'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:52", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: status with args: (<handlers.BotHandlers object at 0x00000233779E0740>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 2, 56, 51, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=7, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2263, supergroup_chat_created=False, text='/status'), update_id=881193500), <telegram.ext._callbackcontext.CallbackContext object at 0x000002331D035010>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:52", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: status with result: <coroutine object BotHandlers.status at 0x000002337D33A260>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:56", "name": "llm_service", "levelname": "INFO", "message": "Empty content on page 7 of document '\u0418\u043d\u0436\u0435\u043d\u0435\u0440\u043d\u043e \u0433\u0435\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0438\u0437\u044b\u0441\u043a\u0430\u043d\u0438\u044f_\u0421\u041f 446.1325800.2019 .pdf'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:57", "name": "llm_service", "levelname": "INFO", "message": "Empty content on page 86 of document '\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438 \u0432\u043e\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f_\u0421\u041f 20.13330.2016.pdf'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:56:58", "name": "llm_service", "levelname": "INFO", "message": "Empty content on page 1 of document '\u041d\u0435\u0441\u0443\u0449\u0438\u0435_\u0438_\u043e\u0433\u0440\u0430\u0436\u0434\u0430\u044e\u0449\u0438\u0435_\u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438_\u0421\u041f_70_13330_2012.pdf'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:57:02", "name": "handlers", "levelname": "INFO", "message": "Provided status to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:57:02", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "decorators", "levelname": "INFO", "message": "Event 'ai_conversation' triggered by user_id=244732168, message='\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0441\u043d\u0435\u0433\u0430 \u0434\u043b\u044f \u0434\u043e\u043c\u0430 \u0432 \u043c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u043b\u0430\u0441\u0442\u0438'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: handle_message with args: (<handlers.BotHandlers object at 0x00000233779E0740>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 2, 58, 5, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2265, supergroup_chat_created=False, text='\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0441\u043d\u0435\u0433\u0430 \u0434\u043b\u044f \u0434\u043e\u043c\u0430 \u0432 \u043c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u043b\u0430\u0441\u0442\u0438'), update_id=881193501), <telegram.ext._callbackcontext.CallbackContext object at 0x000002331D5F80C0>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: handle_message with result: <coroutine object BotHandlers.handle_message at 0x000002331D0A4E50>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "handlers", "levelname": "DEBUG", "message": "Generated conversation_id='b0b647dd-f2ab-4f87-9b05-423742948b37' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "handlers", "levelname": "DEBUG", "message": "Saved user message for conversation_id='b0b647dd-f2ab-4f87-9b05-423742948b37'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "handlers", "levelname": "DEBUG", "message": "Retrieved chat history for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: generate_response with args: (<llm_service.LLMService object at 0x000002331D096B10>, '\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0441\u043d\u0435\u0433\u0430 \u0434\u043b\u044f \u0434\u043e\u043c\u0430 \u0432 \u043c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u043b\u0430\u0441\u0442\u0438'), kwargs: {'chat_history': [HumanMessage(content='\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0441\u043d\u0435\u0433\u0430 \u0434\u043b\u044f \u0434\u043e\u043c\u0430 \u0432 \u043c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u043b\u0430\u0441\u0442\u0438', additional_kwargs={}, response_metadata={}), HumanMessage(content='How much cost the construction of 1m2 of Villas in Bali', additional_kwargs={}, response_metadata={}), AIMessage(content=\"The cost of constructing 1 square meter of a villa in Bali can vary significantly depending on several factors, including the location, design complexity, quality of materials, and the contractor you choose. However, as a general guideline:\\n\\n1. <b>Standard Quality Construction</b>: For a basic villa with standard finishes, the cost typically ranges from approximately USD 500 to USD 800 per square meter.\\n\\n2. <b>Mid-Range Quality Construction</b>: For a villa with mid-range finishes and some custom features, the cost can range from USD... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "llm_service", "levelname": "DEBUG", "message": "Retriever created from vector store.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "llm_service", "levelname": "DEBUG", "message": "History-aware retriever created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:05", "name": "llm_service", "levelname": "DEBUG", "message": "Prompt template for QA chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:06", "name": "llm_service", "levelname": "DEBUG", "message": "Question-answering chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:06", "name": "llm_service", "levelname": "DEBUG", "message": "Retrieval-Augmented Generation (RAG) chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': '\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0441\u043d\u0435\u0433\u0430 \u0434\u043b\u044f \u0434\u043e\u043c\u0430 \u0432 \u043c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u043b\u0430\u0441\u0442\u0438', 'role': 'user'}, {'content': 'How much cost the construction of 1m2 of Villas in Bali', 'role': 'user'}, {'content': \"The cost of constructing 1 square meter of a villa in Bali can vary significantly depending on several factors, including the location, design complexity, quality of materials, and the contractor you choose. However, as a general guideline:\\n\\n1. <b>Standard Quality Construction</b>: For a basic villa with standard finishes, the cost typically ranges from approximately USD 500 to USD 800 per square meter.\\n\\n2. <b>Mid-Range Quality Construction</b>: For a villa with mid-range finishes and some custom features, the cost can range from USD 800 to USD 1,200 per square meter.\\n\\n3. <b>High-End Quality Construction</b>: For luxury villas with high-end finishes, custom designs, and premium materials, th... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 05:58:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 05:58:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers([('date', 'Wed, 27 Nov 2024 02:58:07 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'nuanu-wimbwa'), ('openai-processing-ms', '503'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '800000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '794790'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '390ms'), ('x-request-id', 'req_fadb9cddc0d860244513809cd615794b'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=OKryp4RMBYXJAlOCpxMgdyaA0ZbJrPFARG3dZM9IV3g-1732676287-1.0.1.1-EF7PovQDKsR0nvhiScxqyPQ5YjlTiQmgpZTvCXhzEhW_SJG2fTgyjFbJXMrCnE.cQK4W3TI5jhFIcF3arn66Tw; path=/; expires=Wed, 27-... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 05:58:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_fadb9cddc0d860244513809cd615794b", "taskName": null}
{"asctime": "2024-11-27 05:58:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x000002337D387560>, 'json_data': {'input': [[1, 63385, 2865, 8670, 369, 20658, 14016, 304, 23223, 5654, 14640, 1]], 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}", "taskName": null}
{"asctime": "2024-11-27 05:58:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/embeddings", "taskName": null}
{"asctime": "2024-11-27 05:58:09", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/embeddings \"200 OK\" Headers([('date', 'Wed, 27 Nov 2024 02:58:09 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'nuanu-wimbwa'), ('openai-processing-ms', '117'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '4999987'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_c54f11ef8f421b52a0d3673ebb727815'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=qfwn7f3m5F5mam3a87VnEFzAopS.AG3bAJ.1tiJbrcQ-1732676289-1.0.1.1-4ejDi6J5j42TBslAfo7tJPieaFZC3lUWk1Qbg... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 05:58:09", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_c54f11ef8f421b52a0d3673ebb727815", "taskName": null}
{"asctime": "2024-11-27 05:58:09", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': \"You are a project assistant from the consultant side on design and construction projects. If you don't know the answer, say that you don't know. Do not include references to the source documents in your answer. If you need to use the current date, today is 2024-11-27, 05:58:05. If the prompt includes a request to provide a link to documents in context, respond with: Please follow the link below: Format your response using Telegram-compatible HTML. Use only supported tags (<b>, <strong>, <i>, <em>, <a>, <u>, <s>, <code>, <pre>, <tg-spoiler>) and use \\\\n for line breaks instead of <br>. Use the following pieces of retrieved context to answer the question.\\n\\n\u0421\u041f 20.13330.2016\\n\u0414\u043b\u044f \u043f\u043e\u043a\u0440\u044b\u0442\u0438\u0439 \u0441 \u0443\u043a\u043b\u043e\u043d\u0430\u043c\u0438 \u043e\u0442 12 \u0434\u043e 20 % \u043e\u0434\u043d\u043e\u043f\u0440\u043e\u043b\u0435\u0442\u043d\u044b\u0445 \u0438 \u043c\u043d\u043e\u0433\u043e\u043f\u0440\u043e\u043b\u0435\u0442\u043d\u044b\u0445 \u0437\u0434\u0430\u043d\u0438\u0439 \u0431\u0435\u0437 \u0444\u043e\u043d\u0430\u0440\u0435\u0439, \\n\u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u0443\u0435\u043c\u044b\u0445 \u043d\u0430 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u0442\u0438\u043f\u043e\u0432 \u0410 \u0438\u043b\u0438 \u0412 (\u0441\u043c. \u0441\u0445\u0435\u043c\u044b \u0411.1 \u0438 \u0411.5 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0411), \u0441\u0435= 0,85.\\n10.8 \u0414\u043b\u044f \u043a\u0443\u043f\u043e\u043b\u044c\u043d\u044b\u0445 ... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 05:58:09", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 05:58:14", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 02:58:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '3947', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '790555', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '708ms', 'x-request-id': 'req_b98166c190deaca5b43bc9466c04baba', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e8edad98b102dee-DPS', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 05:58:14", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_b98166c190deaca5b43bc9466c04baba", "taskName": null}
{"asctime": "2024-11-27 05:58:14", "name": "llm_service", "levelname": "DEBUG", "message": "RAG chain invoked with user prompt.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:14", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity ratio: 0.4444444444444444", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:14", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity threshold met. References appended to the answer.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:14", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: generate_response with result: ('\u0414\u043b\u044f \u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0439 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u0441\u043d\u0435\u0433\u043e\u0432\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u0430\u043c\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442 \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0440\u0435\u0433\u0438\u043e\u043d\u0430. \u0421\u043e\u0433\u043b\u0430\u0441\u043d\u043e \u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u043c \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u043d\u043e\u0440\u043c\u0430\u043c, \u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c \u043e\u0431\u044b\u0447\u043d\u043e \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 \u0437\u043e\u043d\u0443 \u0441 \u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u0441\u043d\u0435\u0433\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u043e\u0439 \u0432 \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u0445 180 \u043a\u0433/\u043c\u00b2. \u041e\u0434\u043d\u0430\u043a\u043e \u0442\u043e\u0447\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0436\u0435\u0442 \u0432\u0430\u0440\u044c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0439.\\n\\n\u041f\u0440\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0437\u0434\u0430\u043d\u0438\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0443 \u0441\u043d\u0435\u0433\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0442\u044c \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0441\u0442\u044c \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438. \u042d\u0442\u043e \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u0440\u0430\u0441\u0447\u0435\u0442 \u043d\u0435\u0441\u0443\u0449\u0435\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u043a\u0440\u044b\u0448\u0438 \u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0437\u0434\u0430\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u043f\u043e\u0434\u0432\u0435\u0440\u0433\u0430\u0442\u044c\u0441\u044f \u0432\u043e\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044e \u0441\u043d\u0435\u0433\u0430.\\n\\n\u0414\u043b\u044f \u0431\u043e\u043b\u0435\u0435 \u0442\u043e\u0447\u043d\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0441\u043d\u0435\u0433\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u044d\u043a\u0441\u043f\u0435\u0440\u0442\u0430\u043c \u0438\u043b\u0438 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0430\u043c, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u0443\u0447\u0435\u0441\u0442\u044c \u0432\u0441\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0444\u0430\u043a\u0442\u043e\u0440\u044b \u0438 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0442\u044c \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u0430\u043c.\\n\\n------------------\\nReferences:\\n\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438 \u0432\u043e\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f_\u0421\u041f 20.13330.2016.pdf, pages: 2, 3, 1... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:14", "name": "handlers", "levelname": "INFO", "message": "Generated response for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:14", "name": "handlers", "levelname": "INFO", "message": "Sent response with source files to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:15", "name": "handlers", "levelname": "DEBUG", "message": "Saved bot message for conversation_id='b0b647dd-f2ab-4f87-9b05-423742948b37'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 05:58:15", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=ai_conversation", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:41:09", "name": "root", "levelname": "ERROR", "message": "Exception while handling an update:", "exc_info": "Traceback (most recent call last):\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 72, in map_httpcore_exceptions\n    yield\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 377, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 216, in handle_async_request\n    raise exc from None\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 196, in handle_async_request\n    response = await connection.handle_async_request(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 99, in handle_async_request\n    raise exc\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 76, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 122, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpcore\\_backends\\auto.py\", line 30, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpcore\\_backends\\anyio.py\", line 115, in connect_tcp\n    with map_exceptions(exc_map):\n  File \"C:\\Users\\Andrey\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\contextlib.py\", line 155, in __exit__\n    self.gen.throw(value)\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpcore\\_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: [Errno 11001] getaddrinfo failed\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\request\\_httpxrequest.py\", line 293, in do_request\n    res = await self._client.request(\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpx\\_client.py\", line 1585, in request\n    return await self.send(request, auth=auth, follow_redirects=follow_redirects)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpx\\_client.py\", line 1674, in send\n    response = await self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpx\\_client.py\", line 1702, in _send_handling_auth\n    response = await self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpx\\_client.py\", line 1739, in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpx\\_client.py\", line 1776, in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 376, in handle_async_request\n    with map_httpcore_exceptions():\n  File \"C:\\Users\\Andrey\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\contextlib.py\", line 155, in __exit__\n    self.gen.throw(value)\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 89, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: [Errno 11001] getaddrinfo failed\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\ext\\_updater.py\", line 743, in _network_loop_retry\n    if not await do_action():\n           ^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\ext\\_updater.py\", line 737, in do_action\n    return action_cb_task.result()\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\ext\\_updater.py\", line 367, in polling_action_cb\n    updates = await self.bot.get_updates(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\ext\\_extbot.py\", line 647, in get_updates\n    updates = await super().get_updates(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\_bot.py\", line 4421, in get_updates\n    await self._post(\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\_bot.py\", line 617, in _post\n    return await self._do_post(\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\ext\\_extbot.py\", line 351, in _do_post\n    return await super()._do_post(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\_bot.py\", line 646, in _do_post\n    result = await request.post(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\request\\_baserequest.py\", line 202, in post\n    result = await self._request_wrapper(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\request\\_baserequest.py\", line 334, in _request_wrapper\n    code, payload = await self.do_request(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Python_Projects\\pdflyx\\venv\\Lib\\site-packages\\telegram\\request\\_httpxrequest.py\", line 317, in do_request\n    raise NetworkError(f\"httpx.{err.__class__.__name__}: {err}\") from err\ntelegram.error.NetworkError: httpx.ConnectError: [Errno 11001] getaddrinfo failed", "taskName": "Task-558"}
{"asctime": "2024-11-27 06:48:37", "name": "root", "levelname": "DEBUG", "message": "Logging has been configured successfully.", "taskName": null}
{"asctime": "2024-11-27 06:48:39", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: English (en)", "taskName": "Task-5"}
{"asctime": "2024-11-27 06:48:39", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: Russian (ru)", "taskName": "Task-5"}
{"asctime": "2024-11-27 06:48:39", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: Indonesian (id)", "taskName": "Task-5"}
{"asctime": "2024-11-27 06:48:52", "name": "decorators", "levelname": "DEBUG", "message": "Initialized DatabaseService for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:52", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:53", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:54", "name": "llm_service", "levelname": "INFO", "message": "LLMService initialized with model 'gpt-4o'.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:54", "name": "decorators", "levelname": "DEBUG", "message": "Initialized LLMService.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:54", "name": "decorators", "levelname": "DEBUG", "message": "Set user_id: 244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:54", "name": "decorators", "levelname": "DEBUG", "message": "Set user_name: Andrey", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:54", "name": "decorators", "levelname": "DEBUG", "message": "Set language_code: en", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:54", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:54", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/status'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:54", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: status with args: (<handlers.BotHandlers object at 0x0000020182495550>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 3, 48, 52, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=7, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2267, supergroup_chat_created=False, text='/status'), update_id=881193502), <telegram.ext._callbackcontext.CallbackContext object at 0x00000201A7B9CE50>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:54", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: status with result: <coroutine object BotHandlers.status at 0x0000020187F32110>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:55", "name": "handlers", "levelname": "INFO", "message": "Provided status to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:55", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:58", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:58", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:58", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:58", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/knowledge_base'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:58", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: knowledge_base with args: (<handlers.BotHandlers object at 0x0000020182495550>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 3, 48, 57, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=15, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2269, supergroup_chat_created=False, text='/knowledge_base'), update_id=881193503), <telegram.ext._callbackcontext.CallbackContext object at 0x00000201A7B9E040>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:58", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: knowledge_base with result: <coroutine object BotHandlers.knowledge_base at 0x00000201A7967880>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:58", "name": "handlers", "levelname": "INFO", "message": "Prompted knowledge base selection for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:48:58", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "decorators", "levelname": "INFO", "message": "Event 'inline_button' triggered by user_id=244732168, message='set_knowledge:Indonesian Regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: set_knowledge_base with args: (<handlers.BotHandlers object at 0x0000020182495550>, Update(callback_query=CallbackQuery(chat_instance='-7472414466751896971', data='set_knowledge:Indonesian Regulations', from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), id='1051116661422875673', message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 3, 48, 58, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Pdflyx', id=7836895356, is_bot=True, username='Pdflyx_bot'), group_chat_created=False, message_id=2270, reply_markup=InlineKeyboardMarkup(inline_keyboard=((InlineKeyboardButton(callback_data='set_knowledge:\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b', text='\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b'),), (InlineKeyboardButton(callback_data='set_knowledge:Indonesian Regulations', text='Indonesian Regulations'... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: set_knowledge_base with result: <coroutine object BotHandlers.set_knowledge_base at 0x00000201A6857740>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "handlers", "levelname": "DEBUG", "message": "Set folder_path='E:\\knowledge_base\\indonesian_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "handlers", "levelname": "DEBUG", "message": "Found 18 valid files in folder_path='E:\\knowledge_base\\indonesian_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_and_index_documents with args: (<llm_service.LLMService object at 0x00000201A7C19490>, 'E:\\\\knowledge_base\\\\indonesian_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "llm_service", "levelname": "DEBUG", "message": "Starting load_and_index_documents for folder_path='E:\\knowledge_base\\indonesian_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_vector_store with args: (<llm_service.LLMService object at 0x00000201A7C19490>, 'E:\\\\knowledge_base\\\\indonesian_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "faiss.loader", "levelname": "DEBUG", "message": "Environment variable FAISS_OPT_LEVEL is not set, so let's pick the instruction set according to the current CPU", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "faiss.loader", "levelname": "INFO", "message": "Loading faiss with AVX2 support.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:03", "name": "faiss.loader", "levelname": "INFO", "message": "Successfully loaded faiss with AVX2 support.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:04", "name": "llm_service", "levelname": "INFO", "message": "Loaded vector store from E:\\knowledge_base\\indonesian_regulations\\vector_store", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:04", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_vector_store with result: True", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:04", "name": "llm_service", "levelname": "INFO", "message": "Vector store loaded from existing files in 'E:\\knowledge_base\\indonesian_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:04", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_and_index_documents with result: (True, 'Vector store loaded from existing files.')", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:04", "name": "handlers", "levelname": "INFO", "message": "Knowledge base 'Indonesian Regulations' set successfully for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:04", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=inline_button", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:56", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:56", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:56", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:56", "name": "decorators", "levelname": "INFO", "message": "Event 'ai_conversation' triggered by user_id=244732168, message='\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:56", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: handle_message with args: (<handlers.BotHandlers object at 0x0000020182495550>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 3, 49, 56, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2272, supergroup_chat_created=False, text='\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438'), update_id=881193505), <telegram.ext._callbackcontext.CallbackContext object at 0x00000201A7B9E040>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:56", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: handle_message with result: <coroutine object BotHandlers.handle_message at 0x00000201A7C0C9A0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:56", "name": "handlers", "levelname": "DEBUG", "message": "Generated conversation_id='eccc02ac-ec60-4e25-aae0-d72603e70674' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:57", "name": "handlers", "levelname": "DEBUG", "message": "Saved user message for conversation_id='eccc02ac-ec60-4e25-aae0-d72603e70674'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:57", "name": "handlers", "levelname": "DEBUG", "message": "Retrieved chat history for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:57", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: generate_response with args: (<llm_service.LLMService object at 0x00000201A7C19490>, '\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438'), kwargs: {'chat_history': [HumanMessage(content='\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438', additional_kwargs={}, response_metadata={}), HumanMessage(content='\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0441\u043d\u0435\u0433\u0430 \u0434\u043b\u044f \u0434\u043e\u043c\u0430 \u0432 \u043c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u043b\u0430\u0441\u0442\u0438', additional_kwargs={}, response_metadata={}), AIMessage(content='\u0414\u043b\u044f \u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0439 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u0441\u043d\u0435\u0433\u043e\u0432\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u0430\u043c\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442 \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0440\u0435\u0433\u0438\u043e\u043d\u0430. \u0421\u043e\u0433\u043b\u0430\u0441\u043d\u043e \u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u043c \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u043d\u043e\u0440\u043c\u0430\u043c, \u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c \u043e\u0431\u044b\u0447\u043d\u043e \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 \u0437\u043e\u043d\u0443 \u0441 \u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u0441\u043d\u0435\u0433\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u043e\u0439 \u0432 \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u0445 180 \u043a\u0433/\u043c\u00b2. \u041e\u0434\u043d\u0430\u043a\u043e \u0442\u043e\u0447\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0436\u0435\u0442 \u0432\u0430\u0440\u044c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0439.\\n\\n\u041f\u0440\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0437\u0434\u0430\u043d\u0438\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0443 \u0441\u043d\u0435\u0433\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0442\u044c \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0441\u0442\u044c \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438. \u042d\u0442\u043e \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u0440\u0430\u0441\u0447\u0435\u0442 \u043d\u0435\u0441\u0443\u0449\u0435\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u043a\u0440\u044b\u0448\u0438 \u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0437\u0434\u0430\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:57", "name": "llm_service", "levelname": "DEBUG", "message": "Retriever created from vector store.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:57", "name": "llm_service", "levelname": "DEBUG", "message": "History-aware retriever created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:57", "name": "llm_service", "levelname": "DEBUG", "message": "Prompt template for QA chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:57", "name": "llm_service", "levelname": "DEBUG", "message": "Question-answering chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:57", "name": "llm_service", "levelname": "DEBUG", "message": "Retrieval-Augmented Generation (RAG) chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:49:57", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': '\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438', 'role': 'user'}, {'content': '\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0441\u043d\u0435\u0433\u0430 \u0434\u043b\u044f \u0434\u043e\u043c\u0430 \u0432 \u043c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u043b\u0430\u0441\u0442\u0438', 'role': 'user'}, {'content': '\u0414\u043b\u044f \u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u043e\u0439 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u0441\u043d\u0435\u0433\u043e\u0432\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u0430\u043c\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442 \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0440\u0435\u0433\u0438\u043e\u043d\u0430. \u0421\u043e\u0433\u043b\u0430\u0441\u043d\u043e \u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u043c \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u043d\u043e\u0440\u043c\u0430\u043c, \u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c \u043e\u0431\u044b\u0447\u043d\u043e \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 \u0437\u043e\u043d\u0443 \u0441 \u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u0441\u043d\u0435\u0433\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u043e\u0439 \u0432 \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u0445 180 \u043a\u0433/\u043c\u00b2. \u041e\u0434\u043d\u0430\u043a\u043e \u0442\u043e\u0447\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u0436\u0435\u0442 \u0432\u0430\u0440\u044c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0439.\\n\\n\u041f\u0440\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0437\u0434\u0430\u043d\u0438\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0443 \u0441\u043d\u0435\u0433\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0442\u044c \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0441\u0442\u044c \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438. \u042d\u0442\u043e \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0441\u0435\u0431\u044f \u0440\u0430\u0441\u0447\u0435\u0442 \u043d\u0435\u0441\u0443\u0449\u0435\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u043a\u0440\u044b\u0448\u0438 \u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0437\u0434\u0430\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u043f\u043e\u0434\u0432\u0435\u0440\u0433\u0430\u0442\u044c\u0441\u044f \u0432\u043e\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044e \u0441\u043d\u0435\u0433\u0430.\\n\\n\u0414\u043b\u044f \u0431\u043e\u043b\u0435\u0435 \u0442\u043e\u0447\u043d\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0441\u043d\u0435\u0433\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 06:49:57", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 06:50:01", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers([('date', 'Wed, 27 Nov 2024 03:50:01 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'nuanu-wimbwa'), ('openai-processing-ms', '3972'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '800000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '794849'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '386ms'), ('x-request-id', 'req_0ff69cea4cb8593454dfbedb02eaec60'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=iqqmSAULWQOzMBn2QBJyCnx2J.d4TR8Rhv0iVMFhXhs-1732679401-1.0.1.1-S4frnESBueLhN9Niz1L4Bucyj.Tb3j9Aho06U4vcef.iwjQWlA2k.l0IbCzMCTUHafonl6Tm1xqhdD2Elj1vAA; path=/; expires=Wed, 27... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 06:50:01", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_0ff69cea4cb8593454dfbedb02eaec60", "taskName": null}
{"asctime": "2024-11-27 06:50:01", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x0000020187F87600>, 'json_data': {'input': [[1, 59918, 2865, 10886, 323, 14640, 369, 8246, 304, 64328, 1]], 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}", "taskName": null}
{"asctime": "2024-11-27 06:50:01", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/embeddings", "taskName": null}
{"asctime": "2024-11-27 06:50:02", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/embeddings \"200 OK\" Headers([('date', 'Wed, 27 Nov 2024 03:50:02 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'nuanu-wimbwa'), ('openai-processing-ms', '105'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '4999988'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_22569ca29168d2d1b4486d17c27c3222'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=HzqXt2bdqHaFc_lciOS7.OrnC4PUjNwhr_3XESBugGU-1732679402-1.0.1.1-aJuvKKWOXIMsLERq267aN2W4AMGbANCQhag0q... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 06:50:02", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_22569ca29168d2d1b4486d17c27c3222", "taskName": null}
{"asctime": "2024-11-27 06:50:02", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': \"You are a project assistant from the consultant side on design and construction projects. If you don't know the answer, say that you don't know. Do not include references to the source documents in your answer. If you need to use the current date, today is 2024-11-27, 06:49:57. If the prompt includes a request to provide a link to documents in context, respond with: Please follow the link below: Format your response using Telegram-compatible HTML. Use only supported tags (<b>, <strong>, <i>, <em>, <a>, <u>, <s>, <code>, <pre>, <tg-spoiler>) and use \\\\n for line breaks instead of <br>. Use the following pieces of retrieved context to answer the question.\\n\\n\u201cHak cipta Badan Standardisasi Nasional, copy standar ini dibuat untuk Sub KT 91-01-S4 Bahan, Sain, Struktur & Konstruksi Bangunan, dan tidak untuk dikomersialkan\u201d \\nSNI 1727:2020 \\n201 dari 302 \\n30.1.3   Pembatasan... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 06:50:02", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 06:50:05", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 03:50:05 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '3028', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '792355', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '573ms', 'x-request-id': 'req_ef382cffe45131819b50acf5eb4297b8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e8f26d95878ee30-CGK', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 06:50:05", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_ef382cffe45131819b50acf5eb4297b8", "taskName": null}
{"asctime": "2024-11-27 06:50:05", "name": "llm_service", "levelname": "DEBUG", "message": "RAG chain invoked with user prompt.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:05", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity ratio: 0.0", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:05", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity threshold not met. Returning answer without references.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:05", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: generate_response with result: ('\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0443\u0441\u043b\u043e\u0432\u0438\u0439 \u0440\u0435\u0433\u0438\u043e\u043d\u0430 \u0438 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u043e-\u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u043d\u044b\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0418\u043d\u0434\u043e\u043d\u0435\u0437\u0438\u0438. \u041a\u0430\u043a \u043f\u0440\u0430\u0432\u0438\u043b\u043e, \u0434\u043b\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0437\u0434\u0430\u043d\u0438\u0439 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:\\n\\n1. <b>\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u0435\u0442\u0440\u0430</b>: \u041e\u0441\u043d\u043e\u0432\u043e\u0439 \u0434\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u0432\u0435\u0442\u0440\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043b\u0443\u0436\u0438\u0442 \u0431\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u0435\u0442\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u0436\u0435\u0442 \u0432\u0430\u0440\u044c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u043e\u0441\u0442\u0440\u043e\u0432\u0435 \u0438 \u0432\u044b\u0441\u043e\u0442\u044b \u043d\u0430\u0434 \u0443\u0440\u043e\u0432\u043d\u0435\u043c \u043c\u043e\u0440\u044f.\\n\\n2. <b>\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438</b>: \u0411\u0430\u043b\u0438 \u0438\u043c\u0435\u0435\u0442 \u0440\u0430\u0437\u043d\u043e\u043e\u0431\u0440\u0430\u0437\u043d\u044b\u0439 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043f\u0440\u0438\u0431\u0440\u0435\u0436\u043d\u044b\u0435 \u0437\u043e\u043d\u044b \u0438 \u0433\u043e\u0440\u043d\u044b\u0435 \u0440\u0430\u0439\u043e\u043d\u044b, \u0447\u0442\u043e \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438. \u0420\u0430\u0437\u043d\u044b\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442 \u0432\u043b\u0438\u044f\u043d\u0438\u0435 \u0440\u0435\u043b\u044c\u0435\u0444\u0430 \u0438 \u0440\u0430\u0441\u0442\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u0435\u0442\u0440\u0430.\\n\\n3. <b>\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442\u044b \u0434\u0430\u0432\u043b\u0435\u043d\u0438\u044f</b>: \u0412 \u0440\u0430\u0441\u0447\u0435\u0442\u0435 \u0432\u0435\u0442\u0440\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u043a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442, \u043a\u0430\u043a \u0432\u0435\u0442\u0435\u0440 \u0432\u043e\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u0435\u0442 \u043d\u0430 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438. \u042d\u0442\u0438 \u043a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442\u044b \u0437\u0430\u0432\u0438\u0441\u044f\u0442 \u043e\u0442 \u0444\u043e\u0440\u043c\u044b \u0438 \u0432\u044b\u0441\u043e\u0442\u044b \u0437\u0434\u0430\u043d\u0438\u044f.\\n\\n\u0414\u043b\u044f \u0442\u043e\u0447\u043d\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0432\u0435\u0442\u0440\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u043a \u043c\u0435\u0441\u0442\u043d\u044b\u043c \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u043d\u043e\u0440\u043c\u0430... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:05", "name": "handlers", "levelname": "INFO", "message": "Generated response for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:06", "name": "handlers", "levelname": "INFO", "message": "Sent response to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:06", "name": "handlers", "levelname": "DEBUG", "message": "Saved bot message for conversation_id='eccc02ac-ec60-4e25-aae0-d72603e70674'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:06", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=ai_conversation", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:34", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:34", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:34", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:34", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/status'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:34", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: status with args: (<handlers.BotHandlers object at 0x0000020182495550>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 3, 50, 34, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=7, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2274, supergroup_chat_created=False, text='/status'), update_id=881193506), <telegram.ext._callbackcontext.CallbackContext object at 0x00000201A81D9470>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:34", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: status with result: <coroutine object BotHandlers.status at 0x0000020187F32260>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:35", "name": "llm_service", "levelname": "INFO", "message": "Empty content on page 164 of document 'GUBERNUR BALI PERATURAN DAERAH PROVINSI BALI.pdf'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:35", "name": "llm_service", "levelname": "INFO", "message": "Empty content on page 1 of document 'Persyaratan Umum Instalasi Listrik 2000 - SNI 04-0225-2000.pdf'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:41", "name": "llm_service", "levelname": "INFO", "message": "Empty content on page 1 of document 'SNI-03-7065-2005-plambing.pdf'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:47", "name": "handlers", "levelname": "INFO", "message": "Provided status to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 06:50:47", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:19", "name": "root", "levelname": "DEBUG", "message": "Logging has been configured successfully.", "taskName": null}
{"asctime": "2024-11-27 10:53:20", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: English (en)", "taskName": "Task-5"}
{"asctime": "2024-11-27 10:53:20", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: Russian (ru)", "taskName": "Task-5"}
{"asctime": "2024-11-27 10:53:21", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: Indonesian (id)", "taskName": "Task-5"}
{"asctime": "2024-11-27 10:53:31", "name": "decorators", "levelname": "DEBUG", "message": "Initialized DatabaseService for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:31", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:31", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:32", "name": "llm_service", "levelname": "INFO", "message": "LLMService initialized with model 'gpt-4o'.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:32", "name": "decorators", "levelname": "DEBUG", "message": "Initialized LLMService.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:32", "name": "decorators", "levelname": "DEBUG", "message": "Set user_id: 244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:32", "name": "decorators", "levelname": "DEBUG", "message": "Set user_name: Andrey", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:32", "name": "decorators", "levelname": "DEBUG", "message": "Set language_code: en", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:32", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:32", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/knowledge_base'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:32", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: knowledge_base with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 53, 31, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=15, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2276, supergroup_chat_created=False, text='/knowledge_base'), update_id=881193507), <telegram.ext._callbackcontext.CallbackContext object at 0x000002965F2370E0>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:32", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: knowledge_base with result: <coroutine object BotHandlers.knowledge_base at 0x000002963C0B0CA0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:33", "name": "handlers", "levelname": "INFO", "message": "Prompted knowledge base selection for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:33", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "INFO", "message": "Event 'inline_button' triggered by user_id=244732168, message='set_knowledge:\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: set_knowledge_base with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(callback_query=CallbackQuery(chat_instance='-7472414466751896971', data='set_knowledge:\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b', from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), id='1051116658708489793', message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 53, 33, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Pdflyx', id=7836895356, is_bot=True, username='Pdflyx_bot'), group_chat_created=False, message_id=2277, reply_markup=InlineKeyboardMarkup(inline_keyboard=((InlineKeyboardButton(callback_data='set_knowledge:\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b', text='\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b'),), (InlineKeyboardButton(callback_data='set_knowledge:Indonesian Regulations', text='Indonesian Regulations'),... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: set_knowledge_base with result: <coroutine object BotHandlers.set_knowledge_base at 0x000002965DF775E0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "handlers", "levelname": "DEBUG", "message": "Set folder_path='E:\\knowledge_base\\russian_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "handlers", "levelname": "DEBUG", "message": "Found 28 valid files in folder_path='E:\\knowledge_base\\russian_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_and_index_documents with args: (<llm_service.LLMService object at 0x000002965F328E90>, 'E:\\\\knowledge_base\\\\russian_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "llm_service", "levelname": "DEBUG", "message": "Starting load_and_index_documents for folder_path='E:\\knowledge_base\\russian_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_vector_store with args: (<llm_service.LLMService object at 0x000002965F328E90>, 'E:\\\\knowledge_base\\\\russian_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "faiss.loader", "levelname": "DEBUG", "message": "Environment variable FAISS_OPT_LEVEL is not set, so let's pick the instruction set according to the current CPU", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "faiss.loader", "levelname": "INFO", "message": "Loading faiss with AVX2 support.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "faiss.loader", "levelname": "INFO", "message": "Successfully loaded faiss with AVX2 support.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "llm_service", "levelname": "INFO", "message": "Loaded vector store from E:\\knowledge_base\\russian_regulations\\vector_store", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_vector_store with result: True", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "llm_service", "levelname": "INFO", "message": "Vector store loaded from existing files in 'E:\\knowledge_base\\russian_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:35", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_and_index_documents with result: (True, 'Vector store loaded from existing files.')", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:36", "name": "handlers", "levelname": "INFO", "message": "Knowledge base '\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b' set successfully for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:36", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=inline_button", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "decorators", "levelname": "INFO", "message": "Event 'ai_conversation' triggered by user_id=244732168, message='Iz chego postroit krishu doma'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: handle_message with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 53, 53, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2279, supergroup_chat_created=False, text='Iz chego postroit krishu doma'), update_id=881193509), <telegram.ext._callbackcontext.CallbackContext object at 0x000002965F2370E0>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: handle_message with result: <coroutine object BotHandlers.handle_message at 0x000002965F7804F0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "handlers", "levelname": "DEBUG", "message": "Generated conversation_id='9929495e-dd01-4845-9e69-401956ae2882' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "handlers", "levelname": "DEBUG", "message": "Saved user message for conversation_id='9929495e-dd01-4845-9e69-401956ae2882'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "handlers", "levelname": "DEBUG", "message": "Retrieved chat history for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: generate_response with args: (<llm_service.LLMService object at 0x000002965F328E90>, 'Iz chego postroit krishu doma'), kwargs: {'chat_history': [HumanMessage(content='Iz chego postroit krishu doma', additional_kwargs={}, response_metadata={}), HumanMessage(content='\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438', additional_kwargs={}, response_metadata={}), AIMessage(content='\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0443\u0441\u043b\u043e\u0432\u0438\u0439 \u0440\u0435\u0433\u0438\u043e\u043d\u0430 \u0438 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u043e-\u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u043d\u044b\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0418\u043d\u0434\u043e\u043d\u0435\u0437\u0438\u0438. \u041a\u0430\u043a \u043f\u0440\u0430\u0432\u0438\u043b\u043e, \u0434\u043b\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0437\u0434\u0430\u043d\u0438\u0439 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:\\n\\n1. <b>\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u0435\u0442\u0440\u0430</b>: \u041e\u0441\u043d\u043e\u0432\u043e\u0439 \u0434\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u0432\u0435\u0442\u0440\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043b\u0443\u0436\u0438\u0442 \u0431\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u0435\u0442\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u0436\u0435\u0442 \u0432\u0430\u0440\u044c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u043e\u0441\u0442\u0440\u043e\u0432\u0435 \u0438 \u0432\u044b\u0441\u043e\u0442\u044b \u043d\u0430\u0434 \u0443\u0440\u043e\u0432\u043d\u0435\u043c \u043c\u043e\u0440\u044f.\\n\\n2. <b>\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438</b>: \u0411\u0430\u043b\u0438 \u0438\u043c\u0435\u0435\u0442 \u0440\u0430\u0437\u043d\u043e\u043e\u0431\u0440\u0430\u0437\u043d\u044b\u0439 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043f\u0440\u0438\u0431\u0440\u0435\u0436\u043d\u044b\u0435 \u0437\u043e\u043d\u044b \u0438 \u0433\u043e\u0440\u043d\u044b\u0435 \u0440\u0430\u0439\u043e\u043d\u044b, \u0447\u0442\u043e \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438. \u0420\u0430\u0437\u043d\u044b\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442 \u0432\u043b\u0438\u044f\u043d\u0438\u0435 \u0440\u0435\u043b\u044c\u0435\u0444\u0430 \u0438 \u0440\u0430\u0441\u0442\u0438\u0442\u0435\u043b... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "llm_service", "levelname": "DEBUG", "message": "Retriever created from vector store.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "llm_service", "levelname": "DEBUG", "message": "History-aware retriever created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:53", "name": "llm_service", "levelname": "DEBUG", "message": "Prompt template for QA chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:54", "name": "llm_service", "levelname": "DEBUG", "message": "Question-answering chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:54", "name": "llm_service", "levelname": "DEBUG", "message": "Retrieval-Augmented Generation (RAG) chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:53:54", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': 'Iz chego postroit krishu doma', 'role': 'user'}, {'content': '\u043a\u0430\u043a\u0430\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438', 'role': 'user'}, {'content': '\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043e\u0442 \u0432\u0435\u0442\u0440\u0430 \u043d\u0430 \u0411\u0430\u043b\u0438 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0443\u0441\u043b\u043e\u0432\u0438\u0439 \u0440\u0435\u0433\u0438\u043e\u043d\u0430 \u0438 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u043e-\u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432\u043d\u044b\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0418\u043d\u0434\u043e\u043d\u0435\u0437\u0438\u0438. \u041a\u0430\u043a \u043f\u0440\u0430\u0432\u0438\u043b\u043e, \u0434\u043b\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0437\u0434\u0430\u043d\u0438\u0439 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:\\n\\n1. <b>\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u0435\u0442\u0440\u0430</b>: \u041e\u0441\u043d\u043e\u0432\u043e\u0439 \u0434\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u0432\u0435\u0442\u0440\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043b\u0443\u0436\u0438\u0442 \u0431\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u0435\u0442\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u0436\u0435\u0442 \u0432\u0430\u0440\u044c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u043e\u0441\u0442\u0440\u043e\u0432\u0435 \u0438 \u0432\u044b\u0441\u043e\u0442\u044b \u043d\u0430\u0434 \u0443\u0440\u043e\u0432\u043d\u0435\u043c \u043c\u043e\u0440\u044f.\\n\\n2. <b>\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438</b>: \u0411\u0430\u043b\u0438 \u0438\u043c\u0435\u0435\u0442 \u0440\u0430\u0437\u043d\u043e\u043e\u0431\u0440\u0430\u0437\u043d\u044b\u0439 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043f\u0440\u0438\u0431\u0440\u0435\u0436\u043d\u044b\u0435 \u0437\u043e\u043d\u044b \u0438 \u0433\u043e\u0440\u043d\u044b\u0435 \u0440\u0430\u0439\u043e\u043d\u044b, \u0447\u0442\u043e \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438. \u0420\u0430\u0437\u043d\u044b\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442 \u0432\u043b\u0438\u044f\u043d\u0438\u0435 \u0440\u0435\u043b\u044c\u0435\u0444\u0430 \u0438 \u0440\u0430\u0441\u0442\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u0435\u0442\u0440\u0430.\\n\\n3. <b>\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442\u044b \u0434\u0430\u0432\u043b\u0435\u043d\u0438\u044f</b>: \u0412 \u0440\u0430\u0441\u0447\u0435\u0442\u0435 \u0432\u0435\u0442\u0440\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u043a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442, \u043a... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 10:53:54", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 10:53:56", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers([('date', 'Wed, 27 Nov 2024 07:53:56 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'nuanu-wimbwa'), ('openai-processing-ms', '1753'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '800000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '794935'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '379ms'), ('x-request-id', 'req_9fb95ea95014fc4d07d3909ab38941d7'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ofl2EUl32_Hr6rOjifOHNwqBhMowmbXQ6410jE7iYco-1732694036-1.0.1.1-r5MuWkxhAoQ3zAmw7rOXESPwLYRqqWWDIJgaVN3M3iuMAkGUfIFReBnsIOOLnmQ1B6LuYsfTJ.k6VMo2wkfKqA; path=/; expires=Wed, 27... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 10:53:56", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_9fb95ea95014fc4d07d3909ab38941d7", "taskName": null}
{"asctime": "2024-11-27 10:53:56", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x000002963F6A7560>, 'json_data': {'input': [[96556, 0, 20817, 389, 279, 10652, 11, 264, 9959, 2778, 3319, 311, 9762, 810, 2038, 1436, 387, 1473, 1, 48297, 7384, 369, 4857, 264, 3838, 15485, 304, 64328, 66078, 14640, 20658, 18200, 8312, 1875, 2028, 3319, 14564, 279, 13650, 315, 15485, 8246, 7384, 11, 66078, 14640, 11, 323, 18200, 8312, 38864, 304, 64328, 11, 902, 1051, 14407, 304, 279, 10652, 13]], 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}", "taskName": null}
{"asctime": "2024-11-27 10:53:56", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/embeddings", "taskName": null}
{"asctime": "2024-11-27 10:53:57", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/embeddings \"200 OK\" Headers([('date', 'Wed, 27 Nov 2024 07:53:57 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'nuanu-wimbwa'), ('openai-processing-ms', '43'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '4999939'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_781c4f437914e61c2317eccc9a288a99'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=6x9qOzLqPrfsQSge5CLHcVL4i7b2SyMisMqN4VkwHOY-1732694037-1.0.1.1-qNMCjpMAWqcfIQYs0.ZFkjvzLt2zvouLGloaMh... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 10:53:57", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_781c4f437914e61c2317eccc9a288a99", "taskName": null}
{"asctime": "2024-11-27 10:53:57", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': 'You are a project assistant from the consultant side on design and construction projects. If you don\\'t know the answer, say that you don\\'t know. Do not include references to the source documents in your answer. If you need to use the current date, today is 2024-11-27, 10:53:53. If the prompt includes a request to provide a link to documents in context, respond with: Please follow the link below: Format your response using Telegram-compatible HTML. Use only supported tags (<b>, <strong>, <i>, <em>, <a>, <u>, <s>, <code>, <pre>, <tg-spoiler>) and use \\\\n for line breaks instead of <br>. Use the following pieces of retrieved context to answer the question.\\n\\n\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0411 \\n (\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435)  \\n \\n       \\n \u0422\u0435\u0440\u043c\u0438\u043d\u044b \u0438 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f  \\n\u0411.1 \u0442\u0435\u043f\u043b\u043e\u0432\u0430\u044f \u0437\u0430\u0449\u0438\u0442\u0430 \u0437\u0434\u0430\u043d\u0438\u044f: \u0422\u0435\u043f\u043b\u043e\u0437\u0430\u0449\u0438\u0442\u043d\u044b\u0435 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 \u0441\u043e\u0432\u043e\u043a\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u043d\u0430\u0440\u0443\u0436\u043d\u044b\u0445 \u0438 \\n\u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0445 \u043e\u0433\u0440\u0430\u0436\u0434\u0430\u044e\u0449\u0438\u0445 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0439 \u0437\u0434\u0430\u043d\u0438\u044f, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u0437\u0430\u0434\u0430\u043d\u043d\u044b... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 10:53:57", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 10:54:05", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 07:54:05 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '7504', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '789760', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '767ms', 'x-request-id': 'req_d5ad8634b4cf21b6522ab6b0e688c08e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e908c24c846ee34-CGK', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 10:54:05", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_d5ad8634b4cf21b6522ab6b0e688c08e", "taskName": null}
{"asctime": "2024-11-27 10:54:05", "name": "llm_service", "levelname": "DEBUG", "message": "RAG chain invoked with user prompt.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:05", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity ratio: 0.0", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:05", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity threshold not met. Returning answer without references.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:05", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: generate_response with result: ('\u0412\u044b\u0431\u043e\u0440 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u043e\u0432 \u0434\u043b\u044f \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430 \u043a\u0440\u044b\u0448\u0438 \u0434\u043e\u043c\u0430 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f, \u0431\u044e\u0434\u0436\u0435\u0442, \u0441\u0442\u0438\u043b\u044c \u0434\u043e\u043c\u0430 \u0438 \u043b\u0438\u0447\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0435\u043d\u0438\u044f. \u0412\u043e\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0445 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u043e\u0432 \u0434\u043b\u044f \u043a\u0440\u044b\u0448\u0438:\\n\\n1. <b>\u041c\u0435\u0442\u0430\u043b\u043b</b>:\\n\u2022 \u041c\u0435\u0442\u0430\u043b\u043b\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043a\u0440\u043e\u0432\u043b\u044f (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0438\u0437 \u0441\u0442\u0430\u043b\u0438 \u0438\u043b\u0438 \u0430\u043b\u044e\u043c\u0438\u043d\u0438\u044f) \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0434\u043e\u043b\u0433\u043e\u0432\u0435\u0447\u043d\u043e\u0439 \u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u0430 \u043a \u044d\u043a\u0441\u0442\u0440\u0435\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u043f\u043e\u0433\u043e\u0434\u043d\u044b\u043c \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u043c. \u041e\u043d\u0430 \u0442\u0430\u043a\u0436\u0435 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043b\u0435\u0433\u043a\u0430\u044f \u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u043d\u0430 \u043a\u0440\u044b\u0448\u0430\u0445 \u0441 \u0440\u0430\u0437\u043d\u044b\u043c\u0438 \u043d\u0430\u043a\u043b\u043e\u043d\u0430\u043c\u0438.\\n\\n2. <b>\u0427\u0435\u0440\u0435\u043f\u0438\u0446\u0430</b>:\\n\u2022 \u0413\u043b\u0438\u043d\u044f\u043d\u0430\u044f \u0438\u043b\u0438 \u0431\u0435\u0442\u043e\u043d\u043d\u0430\u044f \u0447\u0435\u0440\u0435\u043f\u0438\u0446\u0430 \u0445\u043e\u0440\u043e\u0448\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u0442\u0435\u043f\u043b\u043e\u0433\u043e \u043a\u043b\u0438\u043c\u0430\u0442\u0430 \u0438 \u043e\u0431\u043b\u0430\u0434\u0430\u0435\u0442 \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u043c\u0438 \u0442\u0435\u043f\u043b\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u043e\u043d\u043d\u044b\u043c\u0438 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430\u043c\u0438. \u041e\u043d\u0430 \u0442\u0430\u043a\u0436\u0435 \u043f\u0440\u0438\u0434\u0430\u0435\u0442 \u043a\u0440\u044b\u0448\u0435 \u044d\u0441\u0442\u0435\u0442\u0438\u0447\u043d\u044b\u0439 \u0432\u0438\u0434.\\n\\n3. <b>\u0413\u0438\u0431\u043a\u0430\u044f \u0447\u0435\u0440\u0435\u043f\u0438\u0446\u0430 (\u0431\u0438\u0442\u0443\u043c\u043d\u0430\u044f)</b>:\\n\u2022 \u042d\u0442\u043e\u0442 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u0435\u043d \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f \u0441\u0432\u043e\u0435\u0439 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u0438 \u043f\u0440\u043e\u0441\u0442\u043e\u0442\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438. \u0413\u0438\u0431\u043a\u0430\u044f \u0447\u0435\u0440\u0435\u043f\u0438\u0446\u0430 \u0445\u043e\u0440\u043e\u0448\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0444\u043e\u0440\u043c \u043a\u0440\u044b\u0448 \u0438 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0445\u043e\u0440\u043e\u0448\u0443\u044e \u0433\u0438\u0434\u0440\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044e.\\n\\n4. <b>\u0414\u0435\u0440\u0435\u0432\u043e</b>:\\n\u2022 \u0414\u0435\u0440\u0435\u0432\u044f\u043d\u043d\u0430\u044f \u0447\u0435\u0440\u0435\u043f\u0438\u0446\u0430 \u0438\u043b\u0438 \u0433\u043e\u043d\u0442\u044b \u043c\u043e\u0433\u0443\u0442 \u043f\u0440\u0438\u0434\u0430\u0442\u044c \u0434\u043e\u043c\u0443 \u0442\u0440\u0430\u0434\u0438\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0438\u043b\u0438 \u0434\u0435\u0440\u0435\u0432\u0435\u043d\u0441\u043a\u0438\u0439 \u0432\u0438\u0434. \u041e\u0434\u043d\u0430\u043a\u043e... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:05", "name": "handlers", "levelname": "INFO", "message": "Generated response for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:05", "name": "handlers", "levelname": "INFO", "message": "Sent response to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:06", "name": "handlers", "levelname": "DEBUG", "message": "Saved bot message for conversation_id='9929495e-dd01-4845-9e69-401956ae2882'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:06", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=ai_conversation", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:15", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:15", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:15", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:15", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/status'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:15", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: status with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 54, 15, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=7, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2281, supergroup_chat_created=False, text='/status'), update_id=881193510), <telegram.ext._callbackcontext.CallbackContext object at 0x000002965F236E40>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:15", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: status with result: <coroutine object BotHandlers.status at 0x000002963F65A8F0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:19", "name": "llm_service", "levelname": "INFO", "message": "Empty content on page 7 of document '\u0418\u043d\u0436\u0435\u043d\u0435\u0440\u043d\u043e \u0433\u0435\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0438\u0437\u044b\u0441\u043a\u0430\u043d\u0438\u044f_\u0421\u041f 446.1325800.2019 .pdf'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:20", "name": "llm_service", "levelname": "INFO", "message": "Empty content on page 86 of document '\u041d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438 \u0432\u043e\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f_\u0421\u041f 20.13330.2016.pdf'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:20", "name": "llm_service", "levelname": "INFO", "message": "Empty content on page 1 of document '\u041d\u0435\u0441\u0443\u0449\u0438\u0435_\u0438_\u043e\u0433\u0440\u0430\u0436\u0434\u0430\u044e\u0449\u0438\u0435_\u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438_\u0421\u041f_70_13330_2012.pdf'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:24", "name": "handlers", "levelname": "INFO", "message": "Provided status to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:54:24", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "decorators", "levelname": "INFO", "message": "Event 'ai_conversation' triggered by user_id=244732168, message='\u043a\u0430\u043a\u043e\u0432\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: handle_message with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 55, 6, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2283, supergroup_chat_created=False, text='\u043a\u0430\u043a\u043e\u0432\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430'), update_id=881193511), <telegram.ext._callbackcontext.CallbackContext object at 0x00000296A241F690>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: handle_message with result: <coroutine object BotHandlers.handle_message at 0x000002965F7804F0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "handlers", "levelname": "DEBUG", "message": "Generated conversation_id='cad53a24-504d-408b-ac4b-a30e8c91373d' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "handlers", "levelname": "DEBUG", "message": "Saved user message for conversation_id='cad53a24-504d-408b-ac4b-a30e8c91373d'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "handlers", "levelname": "DEBUG", "message": "Retrieved chat history for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: generate_response with args: (<llm_service.LLMService object at 0x000002965F328E90>, '\u043a\u0430\u043a\u043e\u0432\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430'), kwargs: {'chat_history': [HumanMessage(content='\u043a\u0430\u043a\u043e\u0432\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430', additional_kwargs={}, response_metadata={}), HumanMessage(content='Iz chego postroit krishu doma', additional_kwargs={}, response_metadata={}), AIMessage(content='\u0412\u044b\u0431\u043e\u0440 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u043e\u0432 \u0434\u043b\u044f \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430 \u043a\u0440\u044b\u0448\u0438 \u0434\u043e\u043c\u0430 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f, \u0431\u044e\u0434\u0436\u0435\u0442, \u0441\u0442\u0438\u043b\u044c \u0434\u043e\u043c\u0430 \u0438 \u043b\u0438\u0447\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0435\u043d\u0438\u044f. \u0412\u043e\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0445 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u043e\u0432 \u0434\u043b\u044f \u043a\u0440\u044b\u0448\u0438:\\n\\n1. <b>\u041c\u0435\u0442\u0430\u043b\u043b</b>:\\n\u2022 \u041c\u0435\u0442\u0430\u043b\u043b\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043a\u0440\u043e\u0432\u043b\u044f (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0438\u0437 \u0441\u0442\u0430\u043b\u0438 \u0438\u043b\u0438 \u0430\u043b\u044e\u043c\u0438\u043d\u0438\u044f) \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0434\u043e\u043b\u0433\u043e\u0432\u0435\u0447\u043d\u043e\u0439 \u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u0430 \u043a \u044d\u043a\u0441\u0442\u0440\u0435\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u043f\u043e\u0433\u043e\u0434\u043d\u044b\u043c \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u043c. \u041e\u043d\u0430 \u0442\u0430\u043a\u0436\u0435 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043b\u0435\u0433\u043a\u0430\u044f \u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u043d\u0430 \u043a\u0440\u044b\u0448\u0430\u0445 \u0441 \u0440\u0430\u0437\u043d\u044b\u043c\u0438 \u043d\u0430\u043a\u043b\u043e\u043d\u0430\u043c\u0438.\\n\\n2. <b>\u0427\u0435\u0440\u0435\u043f\u0438\u0446\u0430</b>:\\n\u2022 \u0413\u043b\u0438\u043d\u044f\u043d\u0430\u044f \u0438\u043b\u0438 \u0431\u0435\u0442\u043e\u043d\u043d\u0430\u044f \u0447\u0435\u0440\u0435\u043f\u0438\u0446\u0430 \u0445\u043e\u0440\u043e\u0448\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u0442\u0435\u043f\u043b\u043e\u0433\u043e \u043a\u043b\u0438\u043c\u0430\u0442\u0430 \u0438 \u043e\u0431\u043b\u0430\u0434\u0430\u0435\u0442 \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u043c\u0438 \u0442\u0435\u043f\u043b\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u043e\u043d\u043d\u044b\u043c\u0438 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430\u043c\u0438. \u041e... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "llm_service", "levelname": "DEBUG", "message": "Retriever created from vector store.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "llm_service", "levelname": "DEBUG", "message": "History-aware retriever created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "llm_service", "levelname": "DEBUG", "message": "Prompt template for QA chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "llm_service", "levelname": "DEBUG", "message": "Question-answering chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "llm_service", "levelname": "DEBUG", "message": "Retrieval-Augmented Generation (RAG) chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': '\u043a\u0430\u043a\u043e\u0432\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430', 'role': 'user'}, {'content': 'Iz chego postroit krishu doma', 'role': 'user'}, {'content': '\u0412\u044b\u0431\u043e\u0440 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u043e\u0432 \u0434\u043b\u044f \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430 \u043a\u0440\u044b\u0448\u0438 \u0434\u043e\u043c\u0430 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f, \u0431\u044e\u0434\u0436\u0435\u0442, \u0441\u0442\u0438\u043b\u044c \u0434\u043e\u043c\u0430 \u0438 \u043b\u0438\u0447\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0435\u043d\u0438\u044f. \u0412\u043e\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0445 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u043e\u0432 \u0434\u043b\u044f \u043a\u0440\u044b\u0448\u0438:\\n\\n1. <b>\u041c\u0435\u0442\u0430\u043b\u043b</b>:\\n\u2022 \u041c\u0435\u0442\u0430\u043b\u043b\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043a\u0440\u043e\u0432\u043b\u044f (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0438\u0437 \u0441\u0442\u0430\u043b\u0438 \u0438\u043b\u0438 \u0430\u043b\u044e\u043c\u0438\u043d\u0438\u044f) \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0434\u043e\u043b\u0433\u043e\u0432\u0435\u0447\u043d\u043e\u0439 \u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u0430 \u043a \u044d\u043a\u0441\u0442\u0440\u0435\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u043f\u043e\u0433\u043e\u0434\u043d\u044b\u043c \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u043c. \u041e\u043d\u0430 \u0442\u0430\u043a\u0436\u0435 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043b\u0435\u0433\u043a\u0430\u044f \u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u043d\u0430 \u043a\u0440\u044b\u0448\u0430\u0445 \u0441 \u0440\u0430\u0437\u043d\u044b\u043c\u0438 \u043d\u0430\u043a\u043b\u043e\u043d\u0430\u043c\u0438.\\n\\n2. <b>\u0427\u0435\u0440\u0435\u043f\u0438\u0446\u0430</b>:\\n\u2022 \u0413\u043b\u0438\u043d\u044f\u043d\u0430\u044f \u0438\u043b\u0438 \u0431\u0435\u0442\u043e\u043d\u043d\u0430\u044f \u0447\u0435\u0440\u0435\u043f\u0438\u0446\u0430 \u0445\u043e\u0440\u043e\u0448\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u0442\u0435\u043f\u043b\u043e\u0433\u043e \u043a\u043b\u0438\u043c\u0430\u0442\u0430 \u0438 \u043e\u0431\u043b\u0430\u0434\u0430\u0435\u0442 \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u043c\u0438 \u0442\u0435\u043f\u043b\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u043e\u043d\u043d\u044b\u043c\u0438 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430\u043c\u0438. \u041e\u043d\u0430 \u0442\u0430\u043a\u0436\u0435 \u043f\u0440\u0438\u0434\u0430\u0435\u0442 \u043a\u0440\u044b\u0448\u0435 \u044d\u0441\u0442\u0435\u0442\u0438\u0447\u043d\u044b\u0439 \u0432\u0438\u0434.\\n\\n3. <b>\u0413\u0438\u0431\u043a\u0430\u044f \u0447\u0435\u0440\u0435\u043f\u0438\u0446\u0430 (\u0431\u0438\u0442\u0443\u043c\u043d\u0430\u044f)</b>:\\n\u2022 \u042d\u0442\u043e\u0442 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u0435\u043d \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f \u0441\u0432\u043e\u0435\u0439 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u0438 \u043f\u0440\u043e\u0441\u0442\u043e\u0442\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 10:55:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 10:55:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 07:55:07 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '477', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '794644', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '401ms', 'x-request-id': 'req_9070e3edc585ba2b88d35a264725b805', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e908dd5fb9bea82-CGK', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 10:55:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_9070e3edc585ba2b88d35a264725b805", "taskName": null}
{"asctime": "2024-11-27 10:55:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x000002963F6CBF60>, 'json_data': {'input': [[1, 51918, 323, 2955, 315, 31741, 27035, 304, 20658, 15316, 304, 64328, 1]], 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}", "taskName": null}
{"asctime": "2024-11-27 10:55:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/embeddings", "taskName": null}
{"asctime": "2024-11-27 10:55:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/embeddings \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 07:55:08 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-ada-002', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '57', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '4999986', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '0s', 'x-request-id': 'req_3372ff6a60f7b9690169d3419682b952', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e908ddbde18e78f-CGK', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 10:55:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_3372ff6a60f7b9690169d3419682b952", "taskName": null}
{"asctime": "2024-11-27 10:55:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': \"You are a project assistant from the consultant side on design and construction projects. If you don't know the answer, say that you don't know. Do not include references to the source documents in your answer. If you need to use the current date, today is 2024-11-27, 10:55:06. If the prompt includes a request to provide a link to documents in context, respond with: Please follow the link below: Format your response using Telegram-compatible HTML. Use only supported tags (<b>, <strong>, <i>, <em>, <a>, <u>, <s>, <code>, <pre>, <tg-spoiler>) and use \\\\n for line breaks instead of <br>. Use the following pieces of retrieved context to answer the question.\\n\\n\u0421\u041f 515.1325800.2022 \\n \\n30 \\n \\n\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0410 \\n\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u044d\u0442\u0430\u043f\u044b \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430                                 \\n\u0437\u0434\u0430\u043d\u0438\u044f \u0438\u0437 \u043a\u043b\u0435\u0435\u043d\u043e\u0433\u043e \u0431\u0440\u0443\u0441\u0430 \\n\u041d\u043e\u043c\u0435\u0440 \\n\u044d\u0442\u0430\u043f\u0430 \\n\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \\n\u0421\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0435 \\n1 \\n\u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043f\u0440... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 10:55:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 10:55:16", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 07:55:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '8053', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '789810', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '764ms', 'x-request-id': 'req_40836ff075ec62dacaf3afe3b79c840a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e908ddf6c55ea82-CGK', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 10:55:16", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_40836ff075ec62dacaf3afe3b79c840a", "taskName": null}
{"asctime": "2024-11-27 10:55:16", "name": "llm_service", "levelname": "DEBUG", "message": "RAG chain invoked with user prompt.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:16", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity ratio: 0.5714285714285714", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:16", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity threshold met. References appended to the answer.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:16", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: generate_response with result: ('\u0423\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u0443\u0447\u0435\u0442\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0442\u0438\u043f \u0433\u0440\u0443\u043d\u0442\u0430, \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0433\u0440\u0443\u043d\u0442\u043e\u0432\u044b\u0445 \u0432\u043e\u0434, \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u0432\u0430\u043b\u0430 \u0438 \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f. \u0412\u043e\u0442 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u044d\u0442\u0430\u043f\u044b \u0438 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435:\\n\\n1. <b>\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u044f</b>:\\n\u2022 \u041e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0434 \u043f\u043e\u043b\u043e\u043c \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u0440\u043e\u0447\u043d\u044b\u043c \u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u044b\u043c.\\n\u2022 \u0415\u0441\u043b\u0438 \u0432 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0438 \u0438\u043c\u0435\u044e\u0442\u0441\u044f \u0441\u043b\u0430\u0431\u044b\u0435 \u0438\u043b\u0438 \u0440\u0430\u0441\u0442\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0433\u0440\u0443\u043d\u0442\u044b (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0442\u043e\u0440\u0444 \u0438\u043b\u0438 \u0447\u0435\u0440\u043d\u043e\u0437\u0435\u043c), \u0438\u0445 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430 \u0431\u043e\u043b\u0435\u0435 \u043f\u043b\u043e\u0442\u043d\u044b\u0435 \u0433\u0440\u0443\u043d\u0442\u044b, \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a \u043f\u0435\u0441\u043e\u043a \u0438\u043b\u0438 \u0433\u0440\u0430\u0432\u0438\u0439.\\n\\n2. <b>\u0413\u0438\u0434\u0440\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f</b>:\\n\u2022 \u041e\u0447\u0435\u043d\u044c \u0432\u0430\u0436\u043d\u043e \u043f\u0440\u0435\u0434\u0443\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0433\u0438\u0434\u0440\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0442\u0438\u0442\u044c \u043f\u0440\u043e\u043d\u0438\u043a\u043d\u043e\u0432\u0435\u043d\u0438\u0435 \u0433\u0440\u0443\u043d\u0442\u043e\u0432\u043e\u0439 \u0432\u043b\u0430\u0433\u0438. \u041e\u0431\u044b\u0447\u043d\u043e \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u0440\u0443\u043b\u043e\u043d\u043d\u044b\u0435 \u0438\u043b\u0438 \u043f\u043b\u0435\u043d\u043e\u0447\u043d\u044b\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b.\\n\u2022 \u0413\u0438\u0434\u0440\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0441\u043b\u043e\u0439 \u0443\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0435 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u043b\u0438\u0432\u043a\u043e\u0439 \u0431\u0435\u0442\u043e\u043d\u043d\u043e\u0433\u043e \u0441\u043b\u043e\u044f.\\n\\n3. <b>\u0422\u0435\u043f\u043b\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f</b>:\\n\u2022 \u0412 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u043e\u0434\u0432\u0430\u043b\u0430 \u0438 \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0443\u0441\u043b\u043e\u0432\u0438\u0439, \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u0442\u0440\u0435\u0431\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0442\u0435\u043f\u043b\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f. \u041e\u0431\u044b\u0447\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u043d\u0435\u043e\u0440\u0433\u0430\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0432\u043b\u0430\u0433\u043e\u0441\u0442\u043e\u0439\u043a\u0438\u0435 \u0443\u0442\u0435\u043f\u043b\u0438\u0442\u0435\u043b\u0438, \u0442\u0430\u043a\u0438... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:16", "name": "handlers", "levelname": "INFO", "message": "Generated response for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:17", "name": "handlers", "levelname": "INFO", "message": "Sent response with source files to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:17", "name": "handlers", "levelname": "DEBUG", "message": "Saved bot message for conversation_id='cad53a24-504d-408b-ac4b-a30e8c91373d'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:17", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=ai_conversation", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:22", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:22", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:22", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:22", "name": "decorators", "levelname": "INFO", "message": "Event 'inline_button' triggered by user_id=244732168, message='get_file:file_2'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:22", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: send_file with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(callback_query=CallbackQuery(chat_instance='-7472414466751896971', data='get_file:file_2', from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), id='1051116659913329958', message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 55, 17, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=20, offset=223, type=<MessageEntityType.BOLD>), MessageEntity(length=13, offset=470, type=<MessageEntityType.BOLD>), MessageEntity(length=13, offset=742, type=<MessageEntityType.BOLD>), MessageEntity(length=15, offset=1011, type=<MessageEntityType.BOLD>), MessageEntity(length=17, offset=1227, type=<MessageEntityType.BOLD>)), from_user=User(first_name='Pdflyx', id=7836895356, is_bot=True, u... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:22", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: send_file with result: <coroutine object BotHandlers.send_file at 0x000002965F309A60>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:23", "name": "handlers", "levelname": "DEBUG", "message": "Initiated async task to send file '\u041f\u043e\u043b\u044b_\u0421\u041f 29.13330.2011.pdf' to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:23", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=inline_button", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:26", "name": "handlers", "levelname": "INFO", "message": "File '\u041f\u043e\u043b\u044b_\u0421\u041f 29.13330.2011.pdf' sent successfully to user_id=244732168.", "taskName": "Task-43"}
{"asctime": "2024-11-27 10:55:50", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:50", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:50", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:50", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/knowledge_base'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:50", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: knowledge_base with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 55, 49, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=15, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2286, supergroup_chat_created=False, text='/knowledge_base'), update_id=881193513), <telegram.ext._callbackcontext.CallbackContext object at 0x000002965F90EF20>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:50", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: knowledge_base with result: <coroutine object BotHandlers.knowledge_base at 0x000002965F2B43A0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:51", "name": "handlers", "levelname": "INFO", "message": "Prompted knowledge base selection for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:51", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "INFO", "message": "Event 'inline_button' triggered by user_id=244732168, message='set_knowledge:ISO Regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: set_knowledge_base with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(callback_query=CallbackQuery(chat_instance='-7472414466751896971', data='set_knowledge:ISO Regulations', from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), id='1051116659325681518', message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 55, 51, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Pdflyx', id=7836895356, is_bot=True, username='Pdflyx_bot'), group_chat_created=False, message_id=2287, reply_markup=InlineKeyboardMarkup(inline_keyboard=((InlineKeyboardButton(callback_data='set_knowledge:\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b', text='\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b'),), (InlineKeyboardButton(callback_data='set_knowledge:Indonesian Regulations', text='Indonesian Regulations'),), (I... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: set_knowledge_base with result: <coroutine object BotHandlers.set_knowledge_base at 0x000002965F308F60>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "handlers", "levelname": "DEBUG", "message": "Set folder_path='E:\\knowledge_base\\iso_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "handlers", "levelname": "DEBUG", "message": "Found 5 valid files in folder_path='E:\\knowledge_base\\iso_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_and_index_documents with args: (<llm_service.LLMService object at 0x000002965F328E90>, 'E:\\\\knowledge_base\\\\iso_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "llm_service", "levelname": "DEBUG", "message": "Starting load_and_index_documents for folder_path='E:\\knowledge_base\\iso_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_vector_store with args: (<llm_service.LLMService object at 0x000002965F328E90>, 'E:\\\\knowledge_base\\\\iso_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "llm_service", "levelname": "INFO", "message": "Loaded vector store from E:\\knowledge_base\\iso_regulations\\vector_store", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_vector_store with result: True", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "llm_service", "levelname": "INFO", "message": "Vector store loaded from existing files in 'E:\\knowledge_base\\iso_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_and_index_documents with result: (True, 'Vector store loaded from existing files.')", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:53", "name": "handlers", "levelname": "INFO", "message": "Knowledge base 'ISO Regulations' set successfully for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:55:54", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=inline_button", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:02", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:02", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "decorators", "levelname": "INFO", "message": "Event 'ai_conversation' triggered by user_id=244732168, message='what is BIM Level 2'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: handle_message with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 56, 2, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2289, supergroup_chat_created=False, text='what is BIM Level 2'), update_id=881193515), <telegram.ext._callbackcontext.CallbackContext object at 0x000002965F90DBE0>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: handle_message with result: <coroutine object BotHandlers.handle_message at 0x00000296A234EF20>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "handlers", "levelname": "DEBUG", "message": "Generated conversation_id='c7aa94aa-69a5-4021-bf55-62b7125b5736' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "handlers", "levelname": "DEBUG", "message": "Saved user message for conversation_id='c7aa94aa-69a5-4021-bf55-62b7125b5736'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "handlers", "levelname": "DEBUG", "message": "Retrieved chat history for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: generate_response with args: (<llm_service.LLMService object at 0x000002965F328E90>, 'what is BIM Level 2'), kwargs: {'chat_history': [HumanMessage(content='what is BIM Level 2', additional_kwargs={}, response_metadata={}), HumanMessage(content='\u043a\u0430\u043a\u043e\u0432\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430', additional_kwargs={}, response_metadata={}), AIMessage(content='\u0423\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u0443\u0447\u0435\u0442\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0442\u0438\u043f \u0433\u0440\u0443\u043d\u0442\u0430, \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0433\u0440\u0443\u043d\u0442\u043e\u0432\u044b\u0445 \u0432\u043e\u0434, \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u0432\u0430\u043b\u0430 \u0438 \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f. \u0412\u043e\u0442 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u044d\u0442\u0430\u043f\u044b \u0438 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435:\\n\\n1. <b>\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u044f</b>:\\n\u2022 \u041e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0434 \u043f\u043e\u043b\u043e\u043c \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u0440\u043e\u0447\u043d\u044b\u043c \u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u044b\u043c.\\n\u2022 \u0415\u0441\u043b\u0438 \u0432 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0438 \u0438\u043c\u0435\u044e\u0442\u0441\u044f \u0441\u043b\u0430\u0431\u044b\u0435 \u0438\u043b\u0438 \u0440\u0430\u0441\u0442\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0433\u0440\u0443\u043d\u0442\u044b (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0442\u043e\u0440\u0444 \u0438\u043b\u0438 \u0447\u0435\u0440\u043d\u043e\u0437\u0435\u043c), \u0438\u0445 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430 \u0431\u043e\u043b\u0435\u0435 \u043f\u043b\u043e\u0442\u043d\u044b\u0435 \u0433\u0440\u0443\u043d\u0442\u044b, \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a \u043f\u0435\u0441\u043e\u043a \u0438\u043b\u0438 \u0433\u0440\u0430\u0432\u0438\u0439.\\n\\n2. <b>\u0413\u0438\u0434\u0440\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f</b>:\\n\u2022 \u041e\u0447\u0435\u043d\u044c \u0432\u0430\u0436\u043d\u043e \u043f\u0440\u0435\u0434\u0443\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0433\u0438\u0434\u0440\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0442\u0438\u0442\u044c \u043f\u0440\u043e\u043d\u0438\u043a\u043d\u043e\u0432\u0435\u043d\u0438\u0435 \u0433\u0440\u0443\u043d\u0442\u043e\u0432\u043e\u0439 \u0432\u043b\u0430\u0433\u0438. \u041e\u0431\u044b\u0447\u043d\u043e \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "llm_service", "levelname": "DEBUG", "message": "Retriever created from vector store.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "llm_service", "levelname": "DEBUG", "message": "History-aware retriever created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "llm_service", "levelname": "DEBUG", "message": "Prompt template for QA chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "llm_service", "levelname": "DEBUG", "message": "Question-answering chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "llm_service", "levelname": "DEBUG", "message": "Retrieval-Augmented Generation (RAG) chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:03", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': 'what is BIM Level 2', 'role': 'user'}, {'content': '\u043a\u0430\u043a\u043e\u0432\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430', 'role': 'user'}, {'content': '\u0423\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435 \u0436\u0438\u043b\u043e\u0433\u043e \u0434\u043e\u043c\u0430 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u0443\u0447\u0435\u0442\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0442\u0438\u043f \u0433\u0440\u0443\u043d\u0442\u0430, \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0433\u0440\u0443\u043d\u0442\u043e\u0432\u044b\u0445 \u0432\u043e\u0434, \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u0432\u0430\u043b\u0430 \u0438 \u043a\u043b\u0438\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f. \u0412\u043e\u0442 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u044d\u0442\u0430\u043f\u044b \u0438 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u043f\u043e\u043b\u043e\u0432 \u0432 \u043f\u043e\u0434\u0432\u0430\u043b\u0435:\\n\\n1. <b>\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u044f</b>:\\n\u2022 \u041e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0434 \u043f\u043e\u043b\u043e\u043c \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u0440\u043e\u0447\u043d\u044b\u043c \u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u044b\u043c.\\n\u2022 \u0415\u0441\u043b\u0438 \u0432 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0438 \u0438\u043c\u0435\u044e\u0442\u0441\u044f \u0441\u043b\u0430\u0431\u044b\u0435 \u0438\u043b\u0438 \u0440\u0430\u0441\u0442\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0433\u0440\u0443\u043d\u0442\u044b (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0442\u043e\u0440\u0444 \u0438\u043b\u0438 \u0447\u0435\u0440\u043d\u043e\u0437\u0435\u043c), \u0438\u0445 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430 \u0431\u043e\u043b\u0435\u0435 \u043f\u043b\u043e\u0442\u043d\u044b\u0435 \u0433\u0440\u0443\u043d\u0442\u044b, \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a \u043f\u0435\u0441\u043e\u043a \u0438\u043b\u0438 \u0433\u0440\u0430\u0432\u0438\u0439.\\n\\n2. <b>\u0413\u0438\u0434\u0440\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f</b>:\\n\u2022 \u041e\u0447\u0435\u043d\u044c \u0432\u0430\u0436\u043d\u043e \u043f\u0440\u0435\u0434\u0443\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0433\u0438\u0434\u0440\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0442\u0438\u0442\u044c \u043f\u0440\u043e\u043d\u0438\u043a\u043d\u043e\u0432\u0435\u043d\u0438\u0435 \u0433\u0440\u0443\u043d\u0442\u043e\u0432\u043e\u0439 \u0432\u043b\u0430\u0433\u0438. \u041e\u0431\u044b\u0447\u043d\u043e \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u0440\u0443\u043b\u043e\u043d\u043d\u044b\u0435 \u0438\u043b\u0438 \u043f\u043b\u0435\u043d\u043e\u0447\u043d\u044b\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b.\\n\u2022 \u0413\u0438\u0434\u0440\u043e\u0438\u0437\u043e\u043b\u044f\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0441\u043b\u043e\u0439 \u0443\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0435 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u043b\u0438\u0432\u043a\u043e\u0439 \u0431\u0435\u0442\u043e\u043d\u043d\u043e... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 10:56:03", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 10:56:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 07:56:06 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '776', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '794760', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '393ms', 'x-request-id': 'req_34a65c1f7794880c11401c2439f744c0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e908f3e8a219185-DPS', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 10:56:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_34a65c1f7794880c11401c2439f744c0", "taskName": null}
{"asctime": "2024-11-27 10:56:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x000002965F7C4B80>, 'json_data': {'input': [[64690, 1829, 9580, 220, 17, 7419, 323, 8292, 304, 8246, 7224, 1]], 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}", "taskName": null}
{"asctime": "2024-11-27 10:56:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/embeddings", "taskName": null}
{"asctime": "2024-11-27 10:56:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/embeddings \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 07:56:07 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-allow-origin': '*', 'access-control-expose-headers': 'X-Request-ID', 'openai-model': 'text-embedding-ada-002', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '81', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '5000000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '4999987', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '0s', 'x-request-id': 'req_45abca62aeb6bbfd2b5f99a8d69ada85', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e908f4b9e1c2dee-DPS', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 10:56:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_45abca62aeb6bbfd2b5f99a8d69ada85", "taskName": null}
{"asctime": "2024-11-27 10:56:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': \"You are a project assistant from the consultant side on design and construction projects. If you don't know the answer, say that you don't know. Do not include references to the source documents in your answer. If you need to use the current date, today is 2024-11-27, 10:56:03. If the prompt includes a request to provide a link to documents in context, respond with: Please follow the link below: Format your response using Telegram-compatible HTML. Use only supported tags (<b>, <strong>, <i>, <em>, <a>, <u>, <s>, <code>, <pre>, <tg-spoiler>) and use \\\\n for line breaks instead of <br>. Use the following pieces of retrieved context to answer the question.\\n\\n\\ufeff\\nOrganization and digitization of information about \\nbuildings and civil engineering works, including building \\ninformation modelling (BIM)\\xa0\u2014 Information management \\nusing building information modelling\\... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 10:56:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 10:56:13", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 07:56:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '5351', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '792807', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '539ms', 'x-request-id': 'req_9899b2f3b8b82b4a7a5a998e77ec6fc1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e908f531b1b9185-DPS', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 10:56:13", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_9899b2f3b8b82b4a7a5a998e77ec6fc1", "taskName": null}
{"asctime": "2024-11-27 10:56:13", "name": "llm_service", "levelname": "DEBUG", "message": "RAG chain invoked with user prompt.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:13", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity ratio: 0.4", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:13", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity threshold met. References appended to the answer.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:13", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: generate_response with result: ('BIM Level 2 refers to a specific level of maturity in the adoption and implementation of Building Information Modelling (BIM) processes and standards. It is characterized by the collaborative production of information using standardized processes and shared information models. Here are some key aspects of BIM Level 2:\\n\\n1. <b>Collaborative Work</b>: At BIM Level 2, all parties involved in a project use their own 3D CAD models, but they are not necessarily working on a single, shared model. Instead, collaboration is achieved by sharing information through a common data environment (CDE).\\n\\n2. <b>Standardized Formats</b>: Information is exchanged using standardized formats such as Industry Foundation Classes (IFC) or Construction Operations Building information exchange (COBie), which ensures compatibility and interoperability between different software platforms.\\n\\n3. <b>Discipline-Specific Models</b>: Each discipline (architecture, ... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:13", "name": "handlers", "levelname": "INFO", "message": "Generated response for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:14", "name": "handlers", "levelname": "INFO", "message": "Sent response with source files to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:14", "name": "handlers", "levelname": "DEBUG", "message": "Saved bot message for conversation_id='c7aa94aa-69a5-4021-bf55-62b7125b5736'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:14", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=ai_conversation", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:17", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:17", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:17", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:17", "name": "decorators", "levelname": "INFO", "message": "Event 'inline_button' triggered by user_id=244732168, message='get_file:file_1'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:17", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: send_file with args: (<handlers.BotHandlers object at 0x0000029639BCB7D0>, Update(callback_query=CallbackQuery(chat_instance='-7472414466751896971', data='get_file:file_1', from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), id='1051116658333860255', message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 56, 13, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=18, offset=324, type=<MessageEntityType.BOLD>), MessageEntity(length=20, offset=590, type=<MessageEntityType.BOLD>), MessageEntity(length=26, offset=863, type=<MessageEntityType.BOLD>), MessageEntity(length=19, offset=1122, type=<MessageEntityType.BOLD>), MessageEntity(length=15, offset=1354, type=<MessageEntityType.BOLD>)), from_user=User(first_name='Pdflyx', id=7836895356, is_bot=True, u... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:17", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: send_file with result: <coroutine object BotHandlers.send_file at 0x000002965F309A60>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:17", "name": "handlers", "levelname": "INFO", "message": "Download access denied for file 'E:\\knowledge_base\\iso_regulations\\BS_EN-ISO_19650-3_2020_Operational Phases.pdf' to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:56:18", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=inline_button", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:38", "name": "root", "levelname": "DEBUG", "message": "Logging has been configured successfully.", "taskName": null}
{"asctime": "2024-11-27 10:59:40", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: English (en)", "taskName": "Task-5"}
{"asctime": "2024-11-27 10:59:40", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: Russian (ru)", "taskName": "Task-5"}
{"asctime": "2024-11-27 10:59:40", "name": "handlers", "levelname": "INFO", "message": "Commands set for language: Indonesian (id)", "taskName": "Task-5"}
{"asctime": "2024-11-27 10:59:47", "name": "decorators", "levelname": "DEBUG", "message": "Initialized DatabaseService for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:47", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:47", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:48", "name": "llm_service", "levelname": "INFO", "message": "LLMService initialized with model 'gpt-4o'.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:48", "name": "decorators", "levelname": "DEBUG", "message": "Initialized LLMService.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:48", "name": "decorators", "levelname": "DEBUG", "message": "Set user_id: 244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:48", "name": "decorators", "levelname": "DEBUG", "message": "Set user_name: Andrey", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:48", "name": "decorators", "levelname": "DEBUG", "message": "Set language_code: en", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:48", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:48", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/status'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:48", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: status with args: (<handlers.BotHandlers object at 0x0000029E4A79B7D0>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 59, 47, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=7, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2292, supergroup_chat_created=False, text='/status'), update_id=881193517), <telegram.ext._callbackcontext.CallbackContext object at 0x0000029E6FE0AEB0>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:48", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: status with result: <coroutine object BotHandlers.status at 0x0000029E5021DFC0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:49", "name": "handlers", "levelname": "INFO", "message": "Provided status to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:49", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:52", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:52", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:52", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:52", "name": "decorators", "levelname": "INFO", "message": "Event 'command' triggered by user_id=244732168, message='/knowledge_base'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:52", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: knowledge_base with args: (<handlers.BotHandlers object at 0x0000029E4A79B7D0>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 59, 52, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=15, offset=0, type=<MessageEntityType.BOT_COMMAND>),), from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2294, supergroup_chat_created=False, text='/knowledge_base'), update_id=881193518), <telegram.ext._callbackcontext.CallbackContext object at 0x0000029E6FE09550>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:52", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: knowledge_base with result: <coroutine object BotHandlers.knowledge_base at 0x0000029E6FD23BE0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:53", "name": "handlers", "levelname": "INFO", "message": "Prompted knowledge base selection for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:53", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=command", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:55", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:55", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "decorators", "levelname": "INFO", "message": "Event 'inline_button' triggered by user_id=244732168, message='set_knowledge:ISO Regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: set_knowledge_base with args: (<handlers.BotHandlers object at 0x0000029E4A79B7D0>, Update(callback_query=CallbackQuery(chat_instance='-7472414466751896971', data='set_knowledge:ISO Regulations', from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), id='1051116658106485409', message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 7, 59, 52, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Pdflyx', id=7836895356, is_bot=True, username='Pdflyx_bot'), group_chat_created=False, message_id=2295, reply_markup=InlineKeyboardMarkup(inline_keyboard=((InlineKeyboardButton(callback_data='set_knowledge:\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b', text='\u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u044b'),), (InlineKeyboardButton(callback_data='set_knowledge:Indonesian Regulations', text='Indonesian Regulations'),), (I... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: set_knowledge_base with result: <coroutine object BotHandlers.set_knowledge_base at 0x0000029E6EB478A0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "handlers", "levelname": "DEBUG", "message": "Set folder_path='E:\\knowledge_base\\iso_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "handlers", "levelname": "DEBUG", "message": "Found 5 valid files in folder_path='E:\\knowledge_base\\iso_regulations' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_and_index_documents with args: (<llm_service.LLMService object at 0x0000029E6FEF96A0>, 'E:\\\\knowledge_base\\\\iso_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "llm_service", "levelname": "DEBUG", "message": "Starting load_and_index_documents for folder_path='E:\\knowledge_base\\iso_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: load_vector_store with args: (<llm_service.LLMService object at 0x0000029E6FEF96A0>, 'E:\\\\knowledge_base\\\\iso_regulations'), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "faiss.loader", "levelname": "DEBUG", "message": "Environment variable FAISS_OPT_LEVEL is not set, so let's pick the instruction set according to the current CPU", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "faiss.loader", "levelname": "INFO", "message": "Loading faiss with AVX2 support.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "faiss.loader", "levelname": "INFO", "message": "Successfully loaded faiss with AVX2 support.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "llm_service", "levelname": "INFO", "message": "Loaded vector store from E:\\knowledge_base\\iso_regulations\\vector_store", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_vector_store with result: True", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "llm_service", "levelname": "INFO", "message": "Vector store loaded from existing files in 'E:\\knowledge_base\\iso_regulations'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: load_and_index_documents with result: (True, 'Vector store loaded from existing files.')", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "handlers", "levelname": "INFO", "message": "Knowledge base 'ISO Regulations' set successfully for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 10:59:56", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=inline_button", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:05", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:05", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "decorators", "levelname": "INFO", "message": "Event 'ai_conversation' triggered by user_id=244732168, message='what is BIM Level 5'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: handle_message with args: (<handlers.BotHandlers object at 0x0000029E4A79B7D0>, Update(message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 8, 0, 5, tzinfo=datetime.timezone.utc), delete_chat_photo=False, from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), group_chat_created=False, message_id=2297, supergroup_chat_created=False, text='what is BIM Level 5'), update_id=881193520), <telegram.ext._callbackcontext.CallbackContext object at 0x0000029E6FE0B3F0>), kwargs: {}", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: handle_message with result: <coroutine object BotHandlers.handle_message at 0x0000029E6FF18680>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "handlers", "levelname": "DEBUG", "message": "Generated conversation_id='8cd98b36-fdee-4a00-a8f0-fa0c71425a55' for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "handlers", "levelname": "DEBUG", "message": "Saved user message for conversation_id='8cd98b36-fdee-4a00-a8f0-fa0c71425a55'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "handlers", "levelname": "DEBUG", "message": "Retrieved chat history for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: generate_response with args: (<llm_service.LLMService object at 0x0000029E6FEF96A0>, 'what is BIM Level 5'), kwargs: {'chat_history': [HumanMessage(content='what is BIM Level 5', additional_kwargs={}, response_metadata={}), HumanMessage(content='what is BIM Level 2', additional_kwargs={}, response_metadata={}), AIMessage(content='BIM Level 2 refers to a specific level of maturity in the adoption and implementation of Building Information Modelling (BIM) processes and standards. It is characterized by the collaborative production of information using standardized processes and shared information models. Here are some key aspects of BIM Level 2:\\n\\n1. <b>Collaborative Work</b>: At BIM Level 2, all parties involved in a project use their own 3D CAD models, but they are not necessarily working on a single, shared model. Instead, collaboration is achieved by sharing information through a common data environment (CDE).\\n\\n2. <b>Standardized Formats</b>: Information is exch... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "llm_service", "levelname": "DEBUG", "message": "Retriever created from vector store.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "llm_service", "levelname": "DEBUG", "message": "History-aware retriever created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "llm_service", "levelname": "DEBUG", "message": "Prompt template for QA chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "llm_service", "levelname": "DEBUG", "message": "Question-answering chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "llm_service", "levelname": "DEBUG", "message": "Retrieval-Augmented Generation (RAG) chain created.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': 'what is BIM Level 5', 'role': 'user'}, {'content': 'what is BIM Level 2', 'role': 'user'}, {'content': 'BIM Level 2 refers to a specific level of maturity in the adoption and implementation of Building Information Modelling (BIM) processes and standards. It is characterized by the collaborative production of information using standardized processes and shared information models. Here are some key aspects of BIM Level 2:\\n\\n1. <b>Collaborative Work</b>: At BIM Level 2, all parties involved in a project use their own 3D CAD models, but they are not necessarily working on a single, shared model. Instead, collaboration is achieved by sharing information through a common data environment (CDE).\\n\\n2. <b>Standardized Formats</b>: Information is exchanged using standardized formats such as Industry Foundation Classes (IFC) or Construction Operations Building information excha... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 11:00:06", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 11:00:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers([('date', 'Wed, 27 Nov 2024 08:00:07 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'nuanu-wimbwa'), ('openai-processing-ms', '1086'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '800000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '795135'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '364ms'), ('x-request-id', 'req_23820cea4713c5daa1ee9e0b6d951912'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=rr30VYFB3wJY8S1p1QcjYGHdJXCNhq0I019yy9FyT7c-1732694407-1.0.1.1-HpKoRXMSHTyV1tnyX28GYamvhDS4B6dvQTbgULypdjAAcCZr1FJEIl2M2piUomheOZgBqOhd6wjKKEGDLVhWEw; path=/; expires=Wed, 27... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 11:00:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_23820cea4713c5daa1ee9e0b6d951912", "taskName": null}
{"asctime": "2024-11-27 11:00:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/embeddings', 'files': None, 'post_parser': <function Embeddings.create.<locals>.parser at 0x0000029E50273600>, 'json_data': {'input': [[1, 3311, 426, 1829, 48261, 5990, 323, 17931, 2737, 426, 1829, 9580, 220, 20, 1]], 'model': 'text-embedding-ada-002', 'encoding_format': 'base64'}}", "taskName": null}
{"asctime": "2024-11-27 11:00:07", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/embeddings", "taskName": null}
{"asctime": "2024-11-27 11:00:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/embeddings \"200 OK\" Headers([('date', 'Wed, 27 Nov 2024 08:00:08 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-allow-origin', '*'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-model', 'text-embedding-ada-002'), ('openai-organization', 'nuanu-wimbwa'), ('openai-processing-ms', '122'), ('openai-version', '2020-10-01'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('x-ratelimit-limit-requests', '5000'), ('x-ratelimit-limit-tokens', '5000000'), ('x-ratelimit-remaining-requests', '4999'), ('x-ratelimit-remaining-tokens', '4999985'), ('x-ratelimit-reset-requests', '12ms'), ('x-ratelimit-reset-tokens', '0s'), ('x-request-id', 'req_acbed1917b243137884f309ca7b5be4b'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=5L.TfwUJGrn59jLVl9ThQeJC2Kms8EZoqCU9yiJdCHs-1732694408-1.0.1.1-sAAeWAEMttobEhs9TlCHnICK_ebNIfxpqOxdt... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 11:00:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_acbed1917b243137884f309ca7b5be4b", "taskName": null}
{"asctime": "2024-11-27 11:00:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'content': 'You are a project assistant from the consultant side on design and construction projects. If you don\\'t know the answer, say that you don\\'t know. Do not include references to the source documents in your answer. If you need to use the current date, today is 2024-11-27, 11:00:06. If the prompt includes a request to provide a link to documents in context, respond with: Please follow the link below: Format your response using Telegram-compatible HTML. Use only supported tags (<b>, <strong>, <i>, <em>, <a>, <u>, <s>, <code>, <pre>, <tg-spoiler>) and use \\\\n for line breaks instead of <br>. Use the following pieces of retrieved context to answer the question.\\n\\n\\ufeff\\nOrganization and digitization of information about \\nbuildings and civil engineering works, including building \\ninformation modelling (BIM)\\xa0\u2014 Information management \\nusing building information modellin... [TRUNCATED]", "taskName": null}
{"asctime": "2024-11-27 11:00:08", "name": "openai._base_client", "levelname": "DEBUG", "message": "Sending HTTP Request: POST https://api.openai.com/v1/chat/completions", "taskName": null}
{"asctime": "2024-11-27 11:00:17", "name": "openai._base_client", "levelname": "DEBUG", "message": "HTTP Response: POST https://api.openai.com/v1/chat/completions \"200 OK\" Headers({'date': 'Wed, 27 Nov 2024 08:00:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'nuanu-wimbwa', 'openai-processing-ms': '8473', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '5000', 'x-ratelimit-limit-tokens': '800000', 'x-ratelimit-remaining-requests': '4999', 'x-ratelimit-remaining-tokens': '792460', 'x-ratelimit-reset-requests': '12ms', 'x-ratelimit-reset-tokens': '565ms', 'x-request-id': 'req_0f259bdb61a7f5dea8169a9a76d5c15c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8e909534ba40ee20-CGK', 'content-encoding': 'gzip', 'alt-svc': 'h3=\":443\"; ma=86400'})", "taskName": null}
{"asctime": "2024-11-27 11:00:17", "name": "openai._base_client", "levelname": "DEBUG", "message": "request_id: req_0f259bdb61a7f5dea8169a9a76d5c15c", "taskName": null}
{"asctime": "2024-11-27 11:00:17", "name": "llm_service", "levelname": "DEBUG", "message": "RAG chain invoked with user prompt.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:17", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity ratio: 0.2", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:17", "name": "llm_service", "levelname": "DEBUG", "message": "Similarity threshold met. References appended to the answer.", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:17", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: generate_response with result: ('BIM Level 5 is not a formally recognized level within the standard definitions of Building Information Modelling (BIM) maturity levels. Typically, BIM maturity is discussed in terms of Levels 0 through 3:\\n\\n1. <b>BIM Level 0</b>: Represents unmanaged CAD with 2D drawings and no collaboration.\\n\\n2. <b>BIM Level 1</b>: Involves managed CAD in 2D or 3D format with a collaboration tool providing a common data environment (CDE), but models are not shared between project team members.\\n\\n3. <b>BIM Level 2</b>: Characterized by collaborative working with each discipline creating its own 3D model, but not necessarily working on a single, shared model. Information is exchanged through a common file format to enable collaboration.\\n\\n4. <b>BIM Level 3</b>: Envisions full collaboration between all disciplines by means of using a single, shared project model that is held in a central environment. All parties can access and modify the same model,... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:17", "name": "handlers", "levelname": "INFO", "message": "Generated response for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:19", "name": "handlers", "levelname": "INFO", "message": "Sent response with source files to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:19", "name": "handlers", "levelname": "DEBUG", "message": "Saved bot message for conversation_id='8cd98b36-fdee-4a00-a8f0-fa0c71425a55'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:19", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=ai_conversation", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:32", "name": "decorators", "levelname": "DEBUG", "message": "User info saved for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:32", "name": "decorators", "levelname": "DEBUG", "message": "Updated last_active for user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:32", "name": "decorators", "levelname": "DEBUG", "message": "Fetched current_language for user_id=244732168: Russian", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:32", "name": "decorators", "levelname": "INFO", "message": "Event 'inline_button' triggered by user_id=244732168, message='get_file:file_0'", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:32", "name": "decorators", "levelname": "DEBUG", "message": "Entering function: send_file with args: (<handlers.BotHandlers object at 0x0000029E4A79B7D0>, Update(callback_query=CallbackQuery(chat_instance='-7472414466751896971', data='get_file:file_0', from_user=User(first_name='Andrey', id=244732168, is_bot=False, is_premium=True, language_code='en', username='Akumsk'), id='1051116661244327462', message=Message(channel_chat_created=False, chat=Chat(first_name='Andrey', id=244732168, type=<ChatType.PRIVATE>, username='Akumsk'), date=datetime.datetime(2024, 11, 27, 8, 0, 18, tzinfo=datetime.timezone.utc), delete_chat_photo=False, entities=(MessageEntity(length=11, offset=209, type=<MessageEntityType.BOLD>), MessageEntity(length=11, offset=290, type=<MessageEntityType.BOLD>), MessageEntity(length=11, offset=472, type=<MessageEntityType.BOLD>), MessageEntity(length=11, offset=710, type=<MessageEntityType.BOLD>), MessageEntity(length=11, offset=1146, type=<MessageEntityType.BOLD>), MessageEntity(length=11, offset=1291, type=<MessageEntityType.BOLD>)... [TRUNCATED]", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:32", "name": "decorators", "levelname": "DEBUG", "message": "Exiting function: send_file with result: <coroutine object BotHandlers.send_file at 0x0000029E6FE810C0>", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:33", "name": "handlers", "levelname": "INFO", "message": "Download access denied for file 'E:\\knowledge_base\\iso_regulations\\BS_EN-ISO_19650-5_2020_Security-minded approach.pdf' to user_id=244732168", "taskName": "Application:7836895356:update_fetcher"}
{"asctime": "2024-11-27 11:00:33", "name": "decorators", "levelname": "DEBUG", "message": "Event log saved for user_id=244732168, event_type=inline_button", "taskName": "Application:7836895356:update_fetcher"}
